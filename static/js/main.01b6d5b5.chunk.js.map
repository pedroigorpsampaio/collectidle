{"version":3,"sources":["assets/0.png","assets/2.png","tile.js","assets/1.png","camera.js","assets/buttons/buttons.png","assets/backgrounds/bg_world.gif","pixicomponent.js","board.js","load.js","assets/blocks/sheet.png","sprite.js","spritesheet.js","index.js"],"names":["Tile","tileSprite","tile0","opacity","this","props","saturation","value","tile2","src","alt","width","config","TILESIZE","camera","zoom","height","style","position","filter","zIndex","top","left","React","PureComponent","Camera","x","INIT_X","y","INIT_Y","speed","min_zoom","max_zoom","angle","PixiComponent","state","tiles","selectedBlock","isBuilding","blocksSheet","blocksData","app","PIXI","window","innerWidth","innerHeight","backgroundAlpha","document","body","appendChild","view","renderBackground","container","sortableChildren","stage","addChild","emptyTex","from","emptyTile","loader","renderButtons","baseTexture","blSheet","parse","Object","keys","textures","map","t","renderTilemap","border","lineStyle","drawRect","screen","interactive","on","e","onMouseDown","onMouseUp","onMouseMove","addEventListener","resize","renderer","onWheel","ticker","add","delta","update","block","removeChildren","updateProjection","isOnScreen","renderProjection","stop","entity","j","BOARD_SIZE","i","Vec2D","bgTex","background","bgSprite","btnSheet","sheet","btnSheetJson","rotateAntiBtn","buttonMode","centerBtn","rotateBtn","stopPropagation","tint","onRotateAntiBtn","onCenterBtn","onRotateBtn","alpha","blendMode","ADD","tZ","dX","getBoardCenter","dY","dTileX","Math","round","dTileY","dInitY","ceil","centerTile","nCols","nRows","minI","maxI","minJ","maxJ","tile","NORMAL","component","ref","thisDiv","gameCanvas","oldW","oldH","targetW","targetH","deltaW","deltaH","clear","BuildBlock","placeI","placeJ","Board","handleMouseClick","event","type","setState","isMouseDown","eX","data","global","eY","lastX","lastY","lastDragX","lastDragY","performance","now","dT","lastClick","handleDoubleClick","handleClick","isDragging","isNewBoard","loadTiles","center","slice","floor","length","assign","offX","offY","button","buttons","mousePos","lastDrag","offset","subtract","updateCamera","placeBlock","direction","matrix","oldCenterX","getCenter","n","tmp","xOffset","idx","convertToMap","topFactor","getTopFactor","console","log","screenX","screenY","limit","TILESIZE_Z","TILE_HALF","trunc","tx","cx","cy","tcy","tcx","offsetY","abs","key","mX","oldI","oldJ","Infinity","isAtCorner","hasNeighbour","right","up","down","upLeft","upRight","downLeft","downRight","resetBlock","scroll","deltaY","oldZoom","newZoom","oldHeight","dH","className","bind","rotate","forceUpdate","removeEventListener","Component","code","onmessage","cmd","PROGRESS_BOARD_LOAD","rows","columns","defaultValue","Int8Array","count","cProgress","self","postMessage","buffer","toString","substring","indexOf","lastIndexOf","blob","Blob","worker_script","URL","createObjectURL","Sprite","filename","scaleX","scaleY","backgroundImage","backgroundPosition","backgroundRepeat","transformOrigin","transform","defaultProps","SpriteSheet","sprite","spriteData","STATE_LOADING","STATE_RUNNING","Game","overflow","preventDefault","loadProgress","loadText","current","loadBoard","list","Array","fill","val","id","name","image","text","arr","cols","push","Worker","boardWorker","Config","progress","matrixify","content","renderLoadingScreen","renderGame","accordions","index","blockName","blockDesc","blockPrice","Card","sx","display","Box","flexDirection","CardContent","flex","Typography","variant","color","maxWidth","alignItems","pl","pb","IconButton","onClick","marginLeft","marginTop","card","Accordion","AccordionSummary","expandIcon","backgroundColor","borderRadius","flexShrink","AccordionDetails","rowHeight","rowRenderer","renderRow","rowCount","ReactDOM","render","getElementById"],"mappings":"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","file":"static/js/main.01b6d5b5.chunk.js","sourcesContent":["export default \"data:image/png;base64,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\"","export default __webpack_public_path__ + \"static/media/2.3b93bd89.png\";","import React from 'react';\r\nimport config from './config.json';\r\nimport tile0 from './assets/0.png';\r\nimport tile1 from './assets/1.png';\r\nimport tile2 from './assets/2.png';\r\n\r\n/**\r\n * Pure component tile class responsible for\r\n * rendering tiles into the game board\r\n */\r\nexport default class Tile extends React.PureComponent {\r\n\r\n    render() {\r\n        var tileSprite = tile0;\r\n        var opacity = this.props.opacity === null ? 1 : this.props.opacity;\r\n        var saturation = this.props.saturation === null ? 1 : this.props.saturation;\r\n    \r\n        if(this.props.value === 0)\r\n        return (null);\r\n        if (this.props.value % 2 === 0)\r\n            tileSprite = tile1;\r\n        else if (this.props.value % 3 === 0)\r\n            tileSprite = tile2;\r\n    \r\n        return (\r\n            <img src={tileSprite} \r\n            alt=\"iso tile\" \r\n            width={config.TILESIZE*this.props.camera.zoom}\r\n            height={config.TILESIZE*this.props.camera.zoom}\r\n            style={{\r\n            opacity: opacity,\r\n            position: 'absolute', \r\n            filter: 'saturate('+saturation+')',\r\n            zIndex: this.props.zIndex,\r\n            top: this.props.top, \r\n            left: this.props.left}}\r\n            />\r\n        );\r\n    }\r\n}","export default \"data:image/png;base64,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\"","import config from './config.json'\r\n\r\n/**\r\n * Camera class for board camera operations\r\n */\r\n export default class Camera {\r\n    x = config.INIT_X;  // current x position of the camera\r\n    y = config.INIT_Y; // current y position of the camera\r\n    speed = 1; // camera speed\r\n    zoom = 1; // current zoom of the camera to the board\r\n    width = 4; // camera width in tiles\r\n    height = 4; // camera height in tiles\r\n    min_zoom = 0.5; // camera height in tiles\r\n    max_zoom = 2; // camera max zoom\r\n    angle = 0; // current camera angle (from 0 to 3 (0, 90, 180 and 270 degrees))\r\n }\r\n","export default __webpack_public_path__ + \"static/media/buttons.c096f3b1.png\";","export default __webpack_public_path__ + \"static/media/bg_world.4fae2a5e.gif\";","import * as React from 'react';\r\nimport * as PIXI from 'pixi.js';\r\nimport emptyTile from './assets/0.png';\r\nimport btnSheet from './assets/buttons/buttons.png';\r\nimport btnSheetJson from './assets/buttons/buttons.json';\r\nimport config from './config.json';\r\nimport * as Vec2D from 'vector2d';\r\nimport background from './assets/backgrounds/bg_world.gif';\r\n\r\nexport class PixiComponent extends React.Component {\r\n  /**\r\n   * After mounting, add the Pixi Renderer to the div and start the Application.\r\n   */\r\n  componentDidMount() {\r\n    this.camera = this.props.state.camera;\r\n    this.tiles = this.props.state.tiles;\r\n    this.selectedBlock = this.props.selectedBlock;\r\n    this.isBuilding = this.selectedBlock > -1 ? true : false;\r\n    this.blocksSheet = this.props.blocksSheet; this.blocksData = this.props.blocksData;\r\n\r\n    this.app = new PIXI.Application({ \r\n      width: window.innerWidth*0.70, height: window.innerHeight*0.95, \r\n      backgroundAlpha: 0, \r\n    });\r\n    document.body.appendChild(this.app.view);\r\n    this.app.view.style.position = 'absolute';this.app.view.style.left = '20px';this.app.view.style.top = '20px';\r\n\r\n    // creates and renders background\r\n    this.renderBackground();\r\n    // create tiles and sprites container\r\n    this.container = new PIXI.Container();\r\n    this.container.sortableChildren = true;\r\n    this.app.stage.addChild(this.container);\r\n    \r\n    // Create empty slot texture\r\n    this.emptyTex = PIXI.Texture.from(emptyTile);\r\n\r\n    // loads buttons spritesheet and render them when loading is complete\r\n    this.loader = new PIXI.Loader();\r\n    this.renderButtons();\r\n\r\n    // creates blocks spritesheet and render them\r\n    const baseTexture = PIXI.BaseTexture.from(this.props.blocksSheet);\r\n    this.blSheet = new PIXI.Spritesheet(baseTexture, this.props.blocksData);\r\n    this.blSheet.parse(() => {\r\n      Object.keys(this.blSheet.textures).map((t) => this.blSheet.textures[t]);\r\n    });\r\n\r\n    // renders tilemap\r\n    this.renderTilemap();\r\n\r\n    // border\r\n    this.border = new PIXI.Graphics();\r\n\r\n    // set the line style to have a width of 5 and set the color to red\r\n    this.border.lineStyle(2, 0x000000);\r\n\r\n    // draw a rectangle border\r\n    this.border.drawRect(this.app.screen.x, this.app.screen.y+1, this.app.screen.width-1, this.app.screen.height-2);\r\n    this.app.stage.addChild(this.border);\r\n\r\n    // mouse interation callbacks\r\n    this.app.stage.interactive = true;\r\n    this.app.stage.on(\"pointerdown\", (e) => this.props.onMouseDown(e));\r\n    this.app.stage.on(\"pointerup\", (e) => this.props.onMouseUp(e));\r\n    this.app.stage.on(\"pointermove\", (e) => this.props.onMouseMove(e));\r\n    //window.addEventListener(\"wheel\", (e) => this.props.onWheel(e));\r\n    window.addEventListener('resize', (e) => this.resize());\r\n    this.app.renderer.view.addEventListener('wheel', (e) => this.props.onWheel(e));\r\n    \r\n    // Listen for animate update\r\n    this.app.ticker.add((delta) => {\r\n      this.update(delta);\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Perform updates based on changes that happened since last tick\r\n   * @param {delta} delta the delta time from last tick\r\n   */\r\n  update(delta) {\r\n    // updates data sent via props\r\n    this.camera = this.props.state.camera;\r\n    this.tiles = this.props.state.tiles;\r\n    this.selectedBlock = this.props.selectedBlock;\r\n    this.isBuilding = this.selectedBlock > -1 ? true : false;\r\n    this.blocksSheet = this.props.blocksSheet; this.blocksData = this.props.blocksData;\r\n    this.block = this.props.state.block;\r\n\r\n    // clears container\r\n    this.container.removeChildren();\r\n    // start rendering \r\n    this.renderTilemap(); // render tilemap\r\n    if(this.isBuilding) { // if it is in building mode\r\n      this.block = this.props.updateProjection(); // updates projection via props method\r\n      if(this.isOnScreen(this.block, config.TILESIZE*this.camera.zoom, config.TILESIZE*this.camera.zoom))\r\n        this.renderProjection(); // render projection (if its on screen)\r\n    }\r\n  }\r\n  \r\n  /**\r\n   * Stop the Application when unmounting.\r\n   */\r\n  componentWillUnmount() {\r\n    this.app.stop();\r\n  }\r\n\r\n  /**\r\n   * Checks if an entity is on viewport screen\r\n   * @param {*} entity the entity to check\r\n   */\r\n  isOnScreen(entity, width, height) {\r\n    let onScreen = !((entity.x > this.app.screen.width) || (entity.x < this.app.screen.x-(width)) ||\r\n                      entity.y > this.app.screen.height || (entity.y < this.app.screen.y-(height)));\r\n    return onScreen;\r\n  }\r\n\r\n  /**\r\n   * Returns a Vec2D with the coordinates to center isometric map with camera at 0\r\n   */\r\n  getBoardCenter() {\r\n    let j = config.BOARD_SIZE;\r\n    let i = config.BOARD_SIZE;\r\n    return new Vec2D.Vector(this.app.screen.width/2 - config.TILESIZE*this.camera.zoom/2 \r\n                                                      - (j-i)*(config.TILESIZE*this.camera.zoom/2)/2, \r\n                                                      this.app.screen.height*0.95/2 - (i+j)*(config.TILESIZE*this.camera.zoom/4)/2);\r\n  }\r\n\r\n  // create and renders background\r\n  renderBackground() {\r\n    // first set the texture\r\n    this.bgTex = new PIXI.Texture.from(background);\r\n    // create the sprite\r\n    this.bgSprite = new PIXI.Sprite(this.bgTex);\r\n    // set the width of the sprite\r\n    this.bgSprite.width = this.app.screen.width;\r\n    this.bgSprite.height = this.app.screen.height;\r\n    // finally add the new sprite\r\n    this.app.stage.addChild(this.bgSprite);\r\n  }\r\n\r\n  // create and renders buttons\r\n  renderButtons() {\r\n    // builds buttons spritesheet\r\n    const baseTexture = PIXI.BaseTexture.from(btnSheet);\r\n    const sheet = new PIXI.Spritesheet(baseTexture, btnSheetJson);\r\n    sheet.parse(() => {\r\n      Object.keys(sheet.textures).map((t) => sheet.textures[t]);\r\n    });\r\n    // create the rotate anticlockwise btn sprite\r\n    this.rotateAntiBtn = new PIXI.Sprite(sheet.textures[\"LeftArrow (1).png\"]);\r\n    this.rotateAntiBtn.interactive = true;\r\n    this.rotateAntiBtn.buttonMode = true;\r\n    // create the center btn sprite\r\n    this.centerBtn = new PIXI.Sprite(sheet.textures[\"Home (1).png\"]);\r\n    this.centerBtn.interactive = true;\r\n    this.centerBtn.buttonMode = true;\r\n    // create the rotate clockwise btn sprite\r\n    this.rotateBtn = new PIXI.Sprite(sheet.textures[\"RightArrow (1).png\"]);\r\n    this.rotateBtn.interactive = true;\r\n    this.rotateBtn.buttonMode = true;\r\n    // set the position and dimensions \r\n    this.rotateAntiBtn.position.x = 30\r\n    this.rotateAntiBtn.position.y = 30;\r\n    this.rotateAntiBtn.width = 30;\r\n    this.rotateAntiBtn.height = 30;\r\n\r\n    this.centerBtn.position.x = this.rotateAntiBtn.position.x + this.rotateAntiBtn.width + 10;\r\n    this.centerBtn.position.y = this.rotateAntiBtn.position.y;\r\n    this.centerBtn.width = 30;\r\n    this.centerBtn.height = 30;\r\n    \r\n    this.rotateBtn.position.x = this.centerBtn.position.x + this.rotateAntiBtn.width + 10;\r\n    this.rotateBtn.position.y = this.centerBtn.position.y;\r\n    this.rotateBtn.width = 30;\r\n    this.rotateBtn.height = 30;\r\n    // set the callbacks\r\n    this.rotateAntiBtn.on(\"pointerdown\", (e) => {e.stopPropagation(); this.rotateAntiBtn.tint=0x1FC012});\r\n    this.rotateAntiBtn.on(\"pointerout\", (e) => {e.stopPropagation(); this.rotateAntiBtn.tint=0xFFFFFF});\r\n    this.rotateAntiBtn.on(\"pointerup\", (e) => {e.stopPropagation(); this.rotateAntiBtn.tint=0xFFFFFF});\r\n    this.rotateAntiBtn.on(\"click\", (e) => this.props.onRotateAntiBtn(e));\r\n\r\n    this.centerBtn.on(\"pointerdown\", (e) => {e.stopPropagation(); this.centerBtn.tint=0x1FC012});\r\n    this.centerBtn.on(\"pointerout\", (e) => {e.stopPropagation(); this.centerBtn.tint=0xFFFFFF});\r\n    this.centerBtn.on(\"pointerup\", (e) => {e.stopPropagation(); this.centerBtn.tint=0xFFFFFF});\r\n    this.centerBtn.on(\"click\", (e) => this.props.onCenterBtn(e));\r\n\r\n    this.rotateBtn.on(\"pointerdown\", (e) => {e.stopPropagation(); this.rotateBtn.tint=0x1FC012});\r\n    this.rotateBtn.on(\"pointerout\", (e) => {e.stopPropagation(); this.rotateBtn.tint=0xFFFFFF});\r\n    this.rotateBtn.on(\"pointerup\", (e) => {e.stopPropagation(); this.rotateBtn.tint=0xFFFFFF});\r\n    this.rotateBtn.on(\"click\", (e) => this.props.onRotateBtn(e));\r\n    // finally add the new button\r\n    this.app.stage.addChild(this.rotateAntiBtn);\r\n    this.app.stage.addChild(this.centerBtn);\r\n    this.app.stage.addChild(this.rotateBtn);\r\n  }\r\n\r\n  /**\r\n   * Render projected tile for building blocks mode\r\n   */\r\n  renderProjection() {\r\n    // create and add block projection to the container\r\n    const block = new PIXI.Sprite(this.blSheet.textures[this.selectedBlock+\".png\"]);\r\n    block.zIndex = this.block.zIndex;\r\n    block.x = this.block.x;\r\n    block.y = this.block.y;\r\n    block.alpha = 0.5;\r\n    block.blendMode = PIXI.BLEND_MODES.ADD;\r\n    block.width = config.TILESIZE*this.camera.zoom;\r\n    block.height = config.TILESIZE*this.camera.zoom;\r\n    this.container.addChild(block);\r\n  }\r\n\r\n  /**\r\n   * Do some culling directly on loop scope\r\n   * to render only visible tiles and renders them \r\n   */\r\n  renderTilemap() {\r\n    let tZ= config.TILESIZE*this.camera.zoom;\r\n    let dX = this.camera.x - this.getBoardCenter().x;\r\n    let dY = this.camera.y - this.getBoardCenter().y;\r\n    let dTileX = Math.round(dX / (tZ/2));\r\n    let dTileY = Math.round(dY / (tZ/2));\r\n    let dInitY = Math.ceil(config.BOARD_SIZE / (2));\r\n    let centerTile = [Math.round(config.BOARD_SIZE/2), Math.round(config.BOARD_SIZE/2)];\r\n    let nCols = Math.ceil(this.app.screen.width / (tZ/2))+3;\r\n    let nRows = Math.ceil(this.app.screen.height / (tZ/2))+4;\r\n    let minI = (centerTile[0]+centerTile[1]-dTileY-dInitY) - (Math.ceil(nRows/2)); let maxI = (centerTile[0]+centerTile[1]-dTileY-dInitY) + (Math.ceil(nRows/2));\r\n    let minJ = (centerTile[0]-centerTile[1]-dTileX) - (Math.ceil(nCols/2)); let maxJ = (centerTile[0]-centerTile[1]-dTileX) + (Math.ceil(nCols/2));\r\n\r\n    // loops only in the visible scope of tiles\r\n    for(let i = minI; i < maxI; i++) {\r\n      for(let j = minJ; j < maxJ; j++) {\r\n        let x = Math.round(i+j/2); // conversion to find the correct tile index visible\r\n        let y = Math.round(i-j/2); \r\n        // border control\r\n        if(x<0 || x>=config.BOARD_SIZE || y<0 || y>= config.BOARD_SIZE) continue;\r\n        // if its not in building mode and there is no tile, do not draw demarcation tiles \r\n        if(!this.isBuilding && this.tiles[y][x] === -1) continue;\r\n        // create and add tile to the container\r\n        const tile = this.tiles[y][x] > -1 ? new PIXI.Sprite(this.blSheet.textures[this.tiles[y][x]+\".png\"]) : \r\n                                              new PIXI.Sprite(this.emptyTex);\r\n        tile.zIndex = y+x+2;\r\n        tile.x = (x-y)*(config.TILESIZE*this.camera.zoom/2) + this.camera.x;\r\n        tile.y = (y+x)*(config.TILESIZE*this.camera.zoom/4) + this.camera.y;\r\n        tile.alpha = this.tiles[y][x] > -1 ? 1 : 0.25;\r\n        tile.blendMode = PIXI.BLEND_MODES.NORMAL;\r\n        tile.width = config.TILESIZE*this.camera.zoom;\r\n        tile.height = config.TILESIZE*this.camera.zoom;\r\n        this.container.addChild(tile);\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Simply render the div that will contain the Pixi Renderer.\r\n   */\r\n  render() {\r\n    let component = this;\r\n    return (\r\n      <div ref={(thisDiv) => {component.gameCanvas = thisDiv}} />\r\n    );\r\n  }\r\n\r\n  // Resize the renderer when window resize happens\r\n  resize() {\r\n    // calculates delta in dimensions\r\n    let oldW = this.app.renderer.width;\r\n    let oldH = this.app.renderer.height;\r\n    let targetW = Math.round(window.innerWidth*0.70);\r\n    let targetH = Math.round(window.innerHeight*0.95);\r\n    let deltaW = targetW - oldW;\r\n    let deltaH = targetH - oldH;\r\n    // updates camera position\r\n    this.camera.x += deltaW/2;\r\n    this.camera.y += deltaH/2;\r\n    // resizes renderer\r\n    this.app.renderer.resize(targetW, targetH);\r\n    // resizes background\r\n    this.bgSprite.width = this.app.screen.width;\r\n    this.bgSprite.height = this.app.screen.height;\r\n    // resizes border\r\n    this.border.clear();\r\n    // set the line style to have a width of 5 and set the color to red\r\n    this.border.lineStyle(2, 0x000000);\r\n    this.border.drawRect(this.app.screen.x+1, this.app.screen.y+1, this.app.screen.width-1, this.app.screen.height-2);\r\n  }\r\n  \r\n}","import React from 'react';\r\nimport config from './config.json'\r\nimport Tile from './tile.js';\r\nimport Camera from './camera.js';\r\nimport * as Vec2D from 'vector2d';\r\nimport { PixiComponent } from './pixicomponent.js';\r\n\r\n/**\r\n * Building block data\r\n */\r\nclass BuildBlock {\r\n  x = 0; // the x position of building block;\r\n  y = 0; // the y position of building block;\r\n  placeI = null; // matrix index I to build block\r\n  placeJ = null; // matrix index J to build block\r\n  zIndex = 2147483646; // the z-index of building block\r\n}\r\n\r\n/**\r\n * The component for the game board/map\r\n * responsible for operations related to the tilemap\r\n */\r\nclass Board extends React.Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      tiles: this.props.tiles,\r\n      x: 0, // mouse current X position\r\n      y: 0, // mouse current Y position\r\n      camera: new Camera(), // creates board camera\r\n      block: new BuildBlock(), // building block data\r\n      isMouseDown: false, // is a mouse button currently down\r\n      isDragging: false, // is the user currently dragging\r\n      lastX: 0,\r\n      lastY: 0,\r\n      lastDragX: 0,\r\n      lastDragY: 0,\r\n      lastClick: 0,\r\n    };\r\n\r\n    // if its a new board, load initial disposition of blocks\r\n    if (this.props.isNewBoard)\r\n      this.loadTiles();\r\n\r\n    //centers camera\r\n    let center = this.getBoardCenter()\r\n    this.state.camera.x = center.x;\r\n    this.state.camera.y = center.y;\r\n  }\r\n\r\n  loadTiles() {\r\n    const tiles = this.state.tiles.slice();\r\n    tiles[Math.floor(config.BOARD_SIZE / 2)][Math.floor(config.BOARD_SIZE / 2)] = 0;\r\n  }\r\n\r\n  /**\r\n   * Returns a Vec2D with the coordinates to center isometric map with camera at 0\r\n   */\r\n  getBoardCenter() {\r\n    let j = config.BOARD_SIZE;\r\n    let i = config.BOARD_SIZE;\r\n    return new Vec2D.Vector(window.innerWidth * 0.70 / 2 - config.TILESIZE * this.state.camera.zoom / 2\r\n      - (j - i) * (config.TILESIZE * this.state.camera.zoom / 2) / 2,\r\n      window.innerHeight * 0.95 / 2 - (i + j) * (config.TILESIZE * this.state.camera.zoom / 4) / 2);\r\n  }\r\n\r\n  /**\r\n   * Position camera in order to position isometric tilemap \r\n   * in the center of the screen \r\n   */\r\n  center() {\r\n    let j = this.state.tiles[0].length;\r\n    let i = this.state.tiles.length;\r\n    let center = new Vec2D.Vector(window.innerWidth * 0.70 / 2 - config.TILESIZE * this.state.camera.zoom / 2\r\n      - (j - i) * (config.TILESIZE * this.state.camera.zoom / 2) / 2,\r\n      window.innerHeight * 0.95 / 2 - (i + j) * (config.TILESIZE * this.state.camera.zoom / 4) / 2)\r\n    const camera = Object.assign({}, this.state.camera);\r\n    camera.x = center.x;\r\n    camera.y = center.y;\r\n    this.setState({ camera: camera });\r\n  }\r\n\r\n  /**\r\n   * Get center coordinates of the isometric map current position\r\n   */\r\n  getCenter() {\r\n    let j = this.state.tiles[0].length;\r\n    let i = this.state.tiles.length;\r\n    let offX = (j - i) * (config.TILESIZE * this.state.camera.zoom / 2) / 2;\r\n    let offY = (i + j) * (config.TILESIZE * this.state.camera.zoom / 4) / 2;\r\n    return new Vec2D.Vector(this.state.camera.x + offX + config.TILESIZE * this.state.camera.zoom / 2,\r\n      this.state.camera.y + offY);\r\n  }\r\n\r\n\r\n  /**\r\n   * Handles mouse up and down events\r\n   * @param {The event that tirggered this callback} event \r\n   */\r\n  handleMouseClick = (event) => {\r\n    if (event.type === \"pointerdown\") {\r\n      this.setState({ isMouseDown: true });\r\n      let eX = event.data.global.x; let eY = event.data.global.y;\r\n      // saves the position last clicked;\r\n      this.setState({ lastX: eX, lastY: eY, lastDragX: eX, lastDragY: eY })\r\n    } else {\r\n      if (this.state.isMouseDown) { // click happened\r\n        let t = performance.now(); // for double click\r\n        let dT = t - this.state.lastClick;\r\n        this.setState({ isMouseDown: false , lastClick: t});\r\n        if(dT < 180) // double click if click happens to close to last one\r\n          this.handleDoubleClick(event)\r\n        else // normal click\r\n          this.handleClick(event, event.data.global.x, event.data.global.y);\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * handles double click events\r\n   * @param {event} event the event that triggered the double click\r\n   */\r\n  handleDoubleClick(event) {\r\n    // double click with left mouse -> center map\r\n    if(event.data.button === 2)\r\n      this.center();\r\n  }\r\n\r\n  /**\r\n   * Handles mouse movements events\r\n   * @param {the event data} e \r\n   */\r\n  onMouseMove(e) {\r\n    e.stopPropagation();\r\n    //e.preventDefault()\r\n    let eX = e.data.global.x; let eY = e.data.global.y;\r\n    this.setState({ x: eX, y: eY });\r\n\r\n    if (this.state.isMouseDown) {\r\n      // drag event\r\n      if (e.data.buttons === 2) {\r\n        // calculates drag direction \r\n        const mousePos = new Vec2D.Vector(e.data.global.x, e.data.global.y);\r\n        const lastDrag = new Vec2D.Vector(this.state.lastDragX, this.state.lastDragY);\r\n        this.setState({ isDragging: true, lastDragX: eX, lastDragY: eY });\r\n        const offset = mousePos.subtract(lastDrag)\r\n        // adjusts camera accordingly\r\n        this.updateCamera(offset)\r\n      } else if (e.data.buttons === 1) { // if it is left click\r\n        let isBuilding = this.props.selectedBlock > -1 ? true : false;\r\n        if (isBuilding) // if it is building\r\n          this.placeBlock(); // delegate block placement to the method responsible for it\r\n      }\r\n    } else {\r\n      this.setState({ isDragging: false });\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Updates camera's current position\r\n   * @param {offset to be added to the camera's current position} offset \r\n   */\r\n  updateCamera(offset) {\r\n    const camera = Object.assign({}, this.state.camera);\r\n    camera.x += offset.x;\r\n    camera.y += offset.y;\r\n    this.setState({ camera: camera });\r\n  }\r\n\r\n  /**\r\n   * Rotates board in the desired direction orientation\r\n   */\r\n  rotate(direction) {\r\n    const matrix = this.state.tiles.slice();\r\n    const oldCenterX = this.getCenter(matrix[0]).x;\r\n\r\n    const n = matrix.length;\r\n\r\n    if (direction === \"clockwise\") { // clockwise\r\n      for (let i = 0; i < n / 2; i++) {\r\n        for (let j = i; j < n - i - 1; j++) {\r\n          let tmp = matrix[i][j];\r\n          matrix[i][j] = matrix[n - j - 1][i];\r\n          matrix[n - j - 1][i] = matrix[n - i - 1][n - j - 1];\r\n          matrix[n - i - 1][n - j - 1] = matrix[j][n - i - 1];\r\n          matrix[j][n - i - 1] = tmp;\r\n        }\r\n      }\r\n    }\r\n    else { // anticlockwise\r\n      for (let i = 0; i < n / 2; i++) {\r\n        for (let j = i; j < n - i - 1; j++) {\r\n          let tmp = matrix[i][j];\r\n          matrix[i][j] = matrix[j][n - 1 - i];\r\n          matrix[j][n - 1 - i] = matrix[n - 1 - i][n - 1 - j];\r\n          matrix[n - 1 - i][n - 1 - j] = matrix[n - 1 - j][i];\r\n          matrix[n - 1 - j][i] = tmp;\r\n        }\r\n      }\r\n    };\r\n    const xOffset = this.getCenter(matrix).x - oldCenterX;\r\n    const camera = Object.assign({}, this.state.camera);\r\n    camera.x -= xOffset;\r\n    this.setState({ tiles: matrix, camera: camera });\r\n  }\r\n\r\n  /**\r\n   * Handles click interactions in the board tiles\r\n   * @param {e} e the event that triggered the click callback\r\n   * @param {the x coord of the click to be handled} x \r\n   * @param {the y coord of the click to be handled} y \r\n   */\r\n  handleClick(e, x, y) {\r\n    let isBuilding = this.props.selectedBlock > -1 ? true : false;\r\n    if (!this.state.isDragging && !isBuilding) {\r\n      const tiles = this.state.tiles.slice();\r\n\r\n      // dont mess with undefined\r\n      if (typeof tiles == \"undefined\")\r\n        return;\r\n\r\n      var idx = this.convertToMap(x, y);\r\n      var i = Math.floor(idx[0]);\r\n      var j = Math.floor(idx[1]);\r\n\r\n      // precision calculation to consider only the top plane of cube\r\n      let topFactor = this.getTopFactor(i, j, x, y);\r\n\r\n      // if it hits some existing block\r\n      if (tiles[i][j] !== 0) {\r\n\r\n        // Click on a valid cube plane!!! Success!!!!!\r\n        if (topFactor > 0 && topFactor <= 1) {\r\n          // tiles[i][j] = 0; // updates it\r\n          console.log(\"clicked on [\" + i + \", \" + j + \"]\");\r\n        }\r\n\r\n      }\r\n\r\n      // updates layers in game state\r\n      this.setState({ tiles: tiles });\r\n    } else if (isBuilding && e.data.button === 0) { // is in building mode (able to place blocks)\r\n      this.placeBlock();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Converts coordinates in the screen space (X,Y) of the page\r\n   * to the map coordinates (i,j)\r\n   * @param {The x - the x coordinate to be converted to map index j } screenX \r\n   * @param {The y - the y coordinate to be converted to map index i } screenY \r\n   * @param {*} limit if calculations should be limited by board boundaries (default = true)\r\n   */\r\n  convertToMap(screenX, screenY, limit = true) {\r\n    let TILESIZE_Z = config.TILESIZE * this.state.camera.zoom;\r\n    let TILE_HALF = TILESIZE_Z / 2;\r\n\r\n    let x = screenX - TILE_HALF - this.state.camera.x;\r\n    let y = screenY - this.state.camera.y;\r\n    let i = Math.trunc((y / TILE_HALF) - (x / TILESIZE_Z));\r\n    let j = Math.trunc((y / TILE_HALF) + (x / TILESIZE_Z));\r\n\r\n    // limits i and j to be inside board boundaries\r\n    if (limit) {\r\n      // makes sure we do not surpass the map 2darray limits\r\n      if (i < 0) i = 0; if (i >= this.state.tiles.length) i = this.state.tiles.length - 1;\r\n      if (j < 0) j = 0; if (j >= this.state.tiles[0].length) j = this.state.tiles[0].length - 1;\r\n    }\r\n\r\n    return [i, j];\r\n  }\r\n\r\n  /**\r\n   * Returns a value that indicates if a point is within\r\n   * the top plane of a given tile in the map\r\n   * (the factor indicates it is in top plane when its value is between 0 and 1)\r\n   * @param {*} i the i-index of the tile to be checked\r\n   * @param {*} j the j-index of the tile to be checked\r\n   * @param {*} screenX the x-index of the mouse click in the page\r\n   * @param {*} screenY the y-index of the mouse click in the page\r\n   * @returns factor that indicates if click is in top plane when its value is between 0 and 1 \r\n   *          or out of the top plane when it is not\r\n   */\r\n  getTopFactor(i, j, screenX, screenY) {\r\n    /**\r\n    * tx,ty: coordinates of the tile in page (top-left orientation)\r\n    * tcx,tcy: coordinates of the middle of the tile\r\n    * cx, cy: coordinates of the click in the page\r\n    * offsetX,Y: offset relation between click and middle of the tile\r\n    * topFactor: factor from that indicates when click is on the top plane of cube (from 0 to 1 = click in top plane)\r\n    */\r\n    let tx = (j - i) * (config.TILESIZE * this.state.camera.zoom / 2) + this.state.camera.x;\r\n    let ty = (i + j) * (config.TILESIZE * this.state.camera.zoom / 4) + this.state.camera.y;\r\n    let cx = screenX;\r\n    let cy = screenY;\r\n    let tcy = ty + (config.TILESIZE * this.state.camera.zoom / 4);\r\n    let tcx = tx + (config.TILESIZE * this.state.camera.zoom / 2);\r\n    let offsetY = Math.abs(cy - tcy) * 2;\r\n    let offsetX = Math.abs(cx - tcx);\r\n    return (offsetX + offsetY) / ((config.TILESIZE * this.state.camera.zoom / 4) + (config.TILESIZE * this.state.camera.zoom / 4));\r\n  }\r\n\r\n  /**\r\n   * Renders the tile\r\n   * @param {The i-index of the tile} i \r\n   * @param {The j-index of the tile} j \r\n   */\r\n  renderTile(i, j, key) {\r\n    return (\r\n      <Tile\r\n        value={this.state.tiles[i][j]}\r\n        key={key}\r\n        camera={this.state.camera}\r\n        zIndex={i + j + 2}\r\n        top={(i + j) * (config.TILESIZE * this.state.camera.zoom / 4) + this.state.camera.y}\r\n        left={(j - i) * (config.TILESIZE * this.state.camera.zoom / 2) + this.state.camera.x}\r\n      />\r\n    )\r\n\r\n  }\r\n\r\n  // renders projection ofselected tile on tilemap on mouse move position\r\n  // and updates placement position valid candidates in case of user click\r\n  updateProjection() {\r\n    const tiles = this.state.tiles.slice();\r\n    const mX = this.state.x;\r\n    const mY = this.state.y;\r\n    var top = mY - this.state.camera.zoom * config.TILESIZE / 4;\r\n    var left = mX - this.state.camera.zoom * config.TILESIZE / 2;\r\n    // placement position (null if not valid)\r\n    var placeI = null; var placeJ = null; var zIndex = 2147483646;\r\n\r\n    var idx = this.convertToMap(this.state.x, this.state.y);\r\n    var i = Math.floor(idx[0]);\r\n    var j = Math.floor(idx[1]);\r\n\r\n    // precision calculation\r\n    let topFactor = this.getTopFactor(i, j, this.state.x, this.state.y);\r\n\r\n    if (tiles[i][j] !== -1) {  // borders of board\r\n      if (topFactor >= 1 && topFactor <= 3) { // is within acceptable distance of border and has neighbour\r\n        idx = this.convertToMap(this.state.x, this.state.y, false); // gets position \r\n        i = Math.floor(idx[0]);\r\n        j = Math.floor(idx[1]);\r\n        const oldI = i; const oldJ = j; // stores preprojection pos with limit at 0\r\n\r\n        if (1 / i === -Infinity) i--; // correction to project with i < 0\r\n        if (1 / j === -Infinity) j--; // correction to project with j < 0\r\n\r\n        if (!this.isAtCorner(i, j)) {\r\n          top = (i + j) * (config.TILESIZE * this.state.camera.zoom / 4) + this.state.camera.y\r\n          left = (j - i) * (config.TILESIZE * this.state.camera.zoom / 2) + this.state.camera.x\r\n          placeI = oldI; placeJ = oldJ; // updates placement indexes with a valid placement position\r\n          zIndex = i + j + 2;\r\n        }\r\n      }\r\n    } else { // empty slot is a valid position if there is a neighbour tile\r\n      const hasNeighbour = this.hasNeighbour(i, j);\r\n\r\n      // if is within the projected top plane of cube to be placed and has a neighbour\r\n      if (topFactor > 0 && topFactor <= 1 && hasNeighbour) {\r\n        //console.log(\"Im a valid poisition to place block\");\r\n        top = (i + j) * (config.TILESIZE * this.state.camera.zoom / 4) + this.state.camera.y\r\n        left = (j - i) * (config.TILESIZE * this.state.camera.zoom / 2) + this.state.camera.x\r\n        placeI = i; placeJ = j; // updates placement indexes with a valid placement position\r\n        zIndex = i + j + 2;\r\n      }\r\n    }\r\n\r\n    // updates block data\r\n    const block = Object.assign({}, this.state.block);\r\n    block.placeI = placeI; block.placeJ = placeJ;\r\n    block.x = left; block.y = top; block.zIndex = zIndex;\r\n    this.setState({block:block});\r\n    return block;\r\n  }\r\n\r\n  /**\r\n   * Return if a tile in a given position (i,j) has a valid neighbour (value != 0)\r\n   * @param {*} i the i-index of the tile to check neighbours\r\n   * @param {*} j the j-index of the tile to check neighbours\r\n   */\r\n  hasNeighbour(i, j) {\r\n    const tiles = this.state.tiles.slice();\r\n    const left = j - 1 >= 0 ? (tiles[i][j - 1] !== -1 ? true : false) : false;\r\n    const right = j + 1 < tiles[i].length ? (tiles[i][j + 1] !== -1 ? true : false) : false;\r\n    const up = i - 1 >= 0 ? (tiles[i - 1][j] !== -1 ? true : false) : false;\r\n    const down = i + 1 < tiles.length ? (tiles[i + 1][j] !== -1 ? true : false) : false;\r\n    return left || right || up || down;\r\n  }\r\n\r\n  /**\r\n   * Check if it is at the corner of board (outside tiles that are attached to one of the four board corners)\r\n   * @param {*} i the i-index of the tile to check if it is at board boundaries corner\r\n   * @param {*} j the j-index of the tile to check if it is at board boundaries corner\r\n   */\r\n  isAtCorner(i, j) {\r\n    const tiles = this.state.tiles.slice();\r\n    const upLeft = j === -1 ? (i === -1 ? true : false) : false;\r\n    const upRight = j === tiles[0].length ? (i === -1 ? true : false) : false;\r\n    const downLeft = j === -1 ? (i === tiles.length ? true : false) : false;\r\n    const downRight = j === tiles[0].length ? (i === tiles.length ? true : false) : false;\r\n    return upLeft || upRight || downLeft || downRight;\r\n  }\r\n\r\n  /**\r\n   * Place block in the stored placement position\r\n   */\r\n  placeBlock() {\r\n    let i = this.state.block.placeI; let j = this.state.block.placeJ;\r\n    let valid = i != null ? (j != null ? (i >= 0 ? (j >= 0 ? (i < config.BOARD_SIZE ?\r\n      (j < config.BOARD_SIZE ? true : false) : false)\r\n      : false) : false) : false) : false;\r\n    if (valid) { // has a valid place to place block\r\n      const tiles = this.state.tiles.slice();\r\n      tiles[i][j] = this.props.selectedBlock;\r\n      this.props.resetBlock();\r\n      this.setState({ tiles: tiles });\r\n    }\r\n  }\r\n\r\n  // change zoom based on mwheel\r\n  onWheel(e) {\r\n    let scroll = -e.deltaY / 3200;\r\n\r\n    if ((this.state.camera.zoom + scroll) > this.state.camera.min_zoom &&\r\n      (this.state.camera.zoom + scroll) <= this.state.camera.max_zoom) {\r\n      const camera = Object.assign({}, this.state.camera);\r\n      const oldZoom = camera.zoom;\r\n      camera.zoom += scroll;\r\n      const newZoom = camera.zoom;\r\n      const oldHeight = config.TILESIZE * config.BOARD_SIZE * oldZoom;\r\n      const newHeight = config.TILESIZE * config.BOARD_SIZE * newZoom;\r\n      const dH = newHeight - oldHeight;\r\n      camera.y = camera.y - dH / 4;\r\n      this.setState({ camera: camera });\r\n    }\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <div>\r\n        <div className='game-board'> \r\n          <PixiComponent onMouseDown={this.handleMouseClick}\r\n            onMouseUp={this.handleMouseClick}\r\n            onMouseMove={this.onMouseMove.bind(this)}\r\n            onWheel={this.onWheel.bind(this)}\r\n            onRotateAntiBtn={() => this.rotate(\"anticlockwise\")}\r\n            onCenterBtn={this.center.bind(this)}\r\n            onRotateBtn={() => this.rotate(\"clockwise\")}\r\n            updateProjection={this.updateProjection.bind(this)}\r\n            state={this.state}\r\n            selectedBlock={this.props.selectedBlock}\r\n            blocksSheet={this.props.blocksSheet} blocksData={this.props.blocksData}/>\r\n        </div>\r\n        {/* <button className=\"rotate-button\" onClick={() => this.rotate(\"anticlockwise\")}>Anti-clockwise</button>\r\n        <button className=\"rotate-button\" onClick={() => this.rotate(\"clockwise\")}>Clockwise</button>\r\n        <button className=\"center-button\" onClick={() => this.center()}>Center</button> */}\r\n      </div>\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Called when component is mounted\r\n   */\r\n  componentDidMount() {\r\n    window.addEventListener('resize', this.resize);\r\n    this.forceUpdate();\r\n    //this.loadTiles(); // load initial tiles\r\n  }\r\n\r\n  /**\r\n   * Called when component is unmounted\r\n   */\r\n  componentWillUnmount() {\r\n    window.removeEventListener('resize', this.resize);\r\n  }\r\n}\r\n\r\nexport default Board;\r\n\r\n\r\n/**\r\n * Creates and fills multidimensional arrays with\r\n * a default value\r\n * Mohammed Ashfaq @ StackOverflow\r\n * @param rows The number of rows for the array\r\n * @param columns The number of columns for the array\r\n * @param defaultValue The default value for each field of the array\r\n * @returns The newly created multidimensional array populated with the default value\r\n */\r\n// function createAndFill2DArray({rows, columns, defaultValue}){\r\n//     return Array.from({ length:rows }, (e, i) => (\r\n//     Array.from({ length:columns }, (e, j)=> defaultValue)));\r\n// }","/**\r\n * Worker listener for loading tasks\r\n */\r\nconst workercode = () => {\r\n    onmessage = function (e) {\r\n        /**\r\n         * Creates a new game board represented by a 2d array\r\n         * @param rows The number of rows for the array\r\n         * @param columns The number of columns for the array\r\n         * @param defaultValue The default value for each field (0 for empty)\r\n         * @returns The newly created multidimensional array populated with the initial disposition of the board\r\n         */\r\n        if (e.data.cmd === \"loadMap\") {\r\n            // progress\r\n            var PROGRESS_BOARD_LOAD = 0;\r\n            // get params\r\n            const rows = e.data.rows; const columns = e.data.columns; const defaultValue = e.data.defaultValue;\r\n            // creates game array as one dimension for faster message transfer\r\n            const tiles = new Int8Array(rows*columns);\r\n            // count for the progress calculation\r\n            var count = 0;\r\n\r\n            // fills array with default value\r\n            for (let i = 0; i < rows; i++) {\r\n                for (let j = 0; j < columns; j++) {\r\n                    tiles[count] = defaultValue;\r\n                    // updates count\r\n                    count++;\r\n                    // send message to main UI thread in case progress changes\r\n                    let cProgress =  Math.round(100 * (count / (rows * columns)));\r\n                    if(cProgress !== PROGRESS_BOARD_LOAD)\r\n                        self.postMessage({'cmd': 'updateProgress', 'progress' : cProgress}); // eslint-disable-line no-restricted-globals\r\n                    // updates loading progress\r\n                    PROGRESS_BOARD_LOAD = cProgress;\r\n                }\r\n            }\r\n            // send the newly created board\r\n            self.postMessage({cmd:'receiveBoard', tiles: tiles.buffer}, [tiles.buffer]); // eslint-disable-line no-restricted-globals\r\n            //self.postMessage(tiles.buffer, [tiles.buffer]); // eslint-disable-line no-restricted-globals\r\n        }\r\n    };\r\n};\r\n\r\nlet code = workercode.toString();\r\ncode = code.substring(code.indexOf(\"{\") + 1, code.lastIndexOf(\"}\"));\r\n\r\nconst blob = new Blob([code], { type: \"application/javascript\" });\r\nconst worker_script = URL.createObjectURL(blob);\r\n\r\nexport function getWorkerScript() { return worker_script }\r\n\r\n\r\n// returns board creation progress\r\n//export function getProgressBoardLoad() { return PROGRESS_BOARD_LOAD; }","export default __webpack_public_path__ + \"static/media/sheet.1761ab07.png\";","import React from 'react';\r\n\r\nconst Sprite = ({ filename, x, y, width, height, scaleX, scaleY }) => {\r\n  if (!filename) {\r\n    return null;\r\n  }\r\n\r\n  const style = {\r\n    backgroundImage: `url(${filename})`,\r\n    backgroundPosition: `${x * (-1)}px ${y * (-1)}px`,\r\n    backgroundRepeat: 'no-repeat',\r\n    width,\r\n    height,\r\n    transformOrigin: '0% 0%',\r\n    transform: `scale(${scaleX}, ${scaleY})`,\r\n  };\r\n\r\n  return <div style={style} />;\r\n};\r\n\r\nSprite.defaultProps = {\r\n  x: 0,\r\n  y: 0,\r\n  width: 0,\r\n  height: 0,\r\n  scaleX: 1,\r\n  scaleY: 1,\r\n};\r\n\r\nexport default Sprite;","import React from 'react';\r\n\r\nimport Sprite from './sprite.js';\r\n\r\nconst SpriteSheet = ({ filename, data, sprite, scaleX, scaleY }) => {\r\n  if (!filename || !data || !sprite) {\r\n    return null;\r\n  }\r\n\r\n  const spriteData = data[\"frames\"][sprite][\"frame\"];\r\n\r\n  return <Sprite filename={filename} x={spriteData[\"x\"]} y={spriteData[\"y\"]} width={spriteData[\"w\"]} height={spriteData[\"h\"]}\r\n                            scaleX = {scaleX} scaleY = {scaleY} />;\r\n};\r\n\r\nSpriteSheet.defaultProps = {\r\n    scaleX: 1,\r\n    scaleY: 1,\r\n  };\r\n\r\nexport default SpriteSheet;","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport './index.css';\r\nimport Board from './board.js';\r\nimport Config from './config.json';\r\nimport * as Load from './load.js';\r\nimport {FpsView} from \"react-fps\";\r\nimport Accordion from '@mui/material/Accordion';\r\nimport AccordionDetails from '@mui/material/AccordionDetails';\r\nimport AccordionSummary from '@mui/material/AccordionSummary';\r\nimport Typography from '@mui/material/Typography';\r\nimport ExpandMoreIcon from '@mui/icons-material/ExpandMore';\r\nimport Box from '@mui/material/Box';\r\nimport Card from '@mui/material/Card';\r\nimport CardContent from '@mui/material/CardContent';\r\nimport IconButton from '@mui/material/IconButton';\r\nimport BuyIcon from '@mui/icons-material/ShoppingCart';\r\nimport blocksSheet from './assets/blocks/sheet.png';\r\nimport blocksData from './assets/blocks/sheet.json';\r\nimport List from 'react-virtualized/dist/commonjs/List';\r\nimport AutoSizer from 'react-virtualized/dist/commonjs/AutoSizer';\r\nimport SpriteSheet from './spritesheet.js';\r\n\r\nexport const STATE_LOADING = 1;\r\nexport const STATE_RUNNING = 2;\r\n\r\nclass Game extends React.Component {\r\n  \r\n  constructor(props) {\r\n    super(props);\r\n    document.body.style.overflow = 'hidden';\r\n    window.addEventListener(\"contextmenu\", e => e.preventDefault());\r\n    this.state = {\r\n      loadProgress: 0,\r\n      selectedBlock: -1,\r\n      loadText: \"Loading map...\",\r\n      current: STATE_LOADING,\r\n      tiles: null,\r\n      isNewBoard: true\r\n    }\r\n  }\r\n  \r\n  // load game components on mount\r\n  componentDidMount () {\r\n    this.loadBoard();\r\n\r\n    this.list = Array(Object.keys(blocksData[\"frames\"]).length).fill().map((val, idx) => {\r\n      return {\r\n        id: idx, \r\n        name: 'John Doe',\r\n        image: 'http://via.placeholder.com/40',\r\n        text: 'loremIpsum',\r\n      }\r\n    });\r\n  }\r\n\r\n  // transform an array into a 2d array/matrix\r\n  matrixify (arr, rows, cols) {\r\n    var matrix = [];\r\n    if (rows * cols === arr.length) {\r\n        for(var i = 0; i < arr.length; i+= cols) {\r\n            matrix.push(arr.slice(i, cols + i));\r\n        }\r\n    }\r\n\r\n    return matrix;\r\n};\r\n  \r\n  /**\r\n   * Loads game board by creating a worker to do the job\r\n   * while update UI until receiving the finished data\r\n   */\r\n  loadBoard() {\r\n    if (window.Worker) {\r\n      // creates worker\r\n      this.boardWorker = new Worker(Load.getWorkerScript());\r\n      // send load map message\r\n      this.boardWorker.postMessage({'cmd': 'loadMap', 'rows': Config.BOARD_SIZE, 'columns': Config.BOARD_SIZE, 'defaultValue': -1});\r\n      this.boardWorker.onmessage = e => {\r\n        if(e.data.cmd === \"updateProgress\")\r\n          this.setState({loadProgress: e.data.progress});\r\n        else  if(e.data.cmd === \"receiveBoard\"){\r\n          const tiles = new Int8Array(e.data.tiles); // gets board as an Uint8Array to be converted to a matrix and stored\r\n          this.setState({tiles: this.matrixify(tiles, Config.BOARD_SIZE, Config.BOARD_SIZE), current:STATE_RUNNING});\r\n        }\r\n      };\r\n\r\n    }\r\n\r\n\r\n   // while(true) console.log(Load.getProgressBoardLoad());\r\n    //this.setState({current:STATE_RUNNING, tiles:tiles});\r\n  }\r\n\r\n  /**\r\n   * Renders the game based on current state\r\n   */\r\n  render() {\r\n    // switch states to get content\r\n    var content = null;\r\n\r\n    switch(this.state.current) {\r\n      case STATE_LOADING:\r\n        content = this.renderLoadingScreen();\r\n        break;\r\n      case STATE_RUNNING:\r\n        content = this.renderGame();  \r\n        break;\r\n      default:\r\n        console.log(\"Unknown game state: Game state must be one of the defined ones\");\r\n        break;\r\n    }\r\n     return content;\r\n  }\r\n\r\n  // Renders Game\r\n  renderGame() {\r\n    return (\r\n      <div className=\"game\" >\r\n        <div>\r\n          <Board tiles={this.state.tiles} isNewBoard={this.state.isNewBoard} \r\n                  selectedBlock={this.state.selectedBlock} resetBlock={this.resetBlock.bind(this)}\r\n                  blocksSheet={blocksSheet} blocksData={blocksData}/>\r\n        </div>\r\n        <div className=\"game-info\">\r\n          <FpsView width={40} height={10} left={0} top={0}/>\r\n          <div>{/* status */}</div>\r\n          <ol>{/* TODO */}</ol>\r\n        </div>\r\n        <div className=\"game-ui\">\r\n          {this.accordions()}\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  // Loads game and render loading screen\r\n  renderLoadingScreen() {\r\n    return (\r\n      <div className=\"game\" >\r\n        <div>\r\n          {this.state.loadText} ({this.state.loadProgress})\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  /**\r\n   *  Block card\r\n   */\r\n  card (index) {\r\n    let sprite = index+'.png';// sprite is named based on index\r\n    let blockName = blocksData[\"frames\"][sprite][\"name\"];\r\n    let blockDesc = blocksData[\"frames\"][sprite][\"desc\"];\r\n    let blockPrice = blocksData[\"frames\"][sprite][\"price\"];\r\n    return (\r\n      <Card sx={{ display: 'flex' }}>\r\n        <Box sx={{ display: 'flex', flexDirection: 'column' }}>\r\n          <CardContent sx={{ flex: '1 0 auto' }}>\r\n            <Typography component=\"div\" variant=\"h6\">\r\n              {blockName}\r\n            </Typography>\r\n            <Typography variant=\"subtitle2\" color=\"text.secondary\" component=\"div\" sx={{ maxWidth: '13vw' }}>\r\n              {blockDesc}\r\n            </Typography>\r\n          </CardContent>\r\n          <Box sx={{ display: 'flex', alignItems: 'center', pl: 2, pb: 0 }}>\r\n            <Typography variant=\"subtitle1\" color=\"gold\" component=\"div\">\r\n              Price: {blockPrice}\r\n            </Typography>\r\n            <IconButton aria-label=\"buy\" onClick={()=>this.setState({selectedBlock: index})}> \r\n              <BuyIcon sx={{ height: 38, width: 38 }} />\r\n            </IconButton>\r\n          </Box>\r\n        </Box>\r\n        {/* <CardMedia\r\n          component=\"img\"\r\n          sx={{mt:'5vh' , ml: '5vw', width: 64, height:64}}\r\n          image={tile1}\r\n          alt=\"Live from space album cover\"\r\n        /> */}\r\n        <div style = {{position:'absolute', marginLeft: '75%', marginTop: '10%'}}>\r\n          <SpriteSheet filename={blocksSheet} data={blocksData} sprite={sprite} scaleX={0.25} scaleY={0.25}/>\r\n        </div>\r\n      </Card>\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Renders each row of virtualized list\r\n   */\r\n  renderRow({ index, key, style }) {\r\n    return (\r\n      <div key={key} style={style} className=\"row\">\r\n        <div className=\"content\">\r\n          <div>{this.card(index)}</div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  resetBlock = () => {this.setState({selectedBlock: -1})}\r\n\r\n  /**\r\n   * The side UI accordion\r\n   */\r\n  accordions() {\r\n  \r\n    // const handleChange = (panel) => (event, isExpanded) => {\r\n    //   let val = (isExpanded ? panel : false);\r\n    //   this.setState({expanded: val});\r\n    // };\r\n\r\n    /*\r\n    ref={ (ref) => this.accRef=ref }  onMouseDown={(e) => this.handleMouseClick(e)} \r\n                                        onMouseMove={(e) => this.onMouseMove(e)}\r\n                                        onMouseUp={(e) => this.handleMouseClick(e)}*/\r\n    return (\r\n      <div className = 'accordion' onMouseDown={(e) => e.preventDefault()}>\r\n        <div className = 'accordion-child'>\r\n          <Accordion>\r\n            <AccordionSummary\r\n              expandIcon={<ExpandMoreIcon />}\r\n              aria-controls=\"panel1bh-content\"\r\n              id=\"panel1bh-header\"\r\n              sx={{backgroundColor: '#fbeaab', 'border': '1px solid #61265b', borderRadius : '2px'}}\r\n            >\r\n              <Typography sx={{ width: '33%', flexShrink: 0 }}>\r\n                Blocks\r\n              </Typography>\r\n              {/* <Typography sx={{ color: 'text.secondary' }}>You are currently not an owner</Typography> */}\r\n            </AccordionSummary>\r\n            <AccordionDetails  sx={{backgroundColor: '#fbeaab'}}>\r\n              <div className=\"list\">\r\n                <AutoSizer>\r\n                {({ width, height }) => {\r\n                  return <List\r\n                    width={width}\r\n                    height={height}\r\n                    rowHeight={150}\r\n                    rowRenderer={this.renderRow.bind(this)}\r\n                    rowCount={this.list.length} />\r\n                }}\r\n                </AutoSizer>\r\n              </div>\r\n            </AccordionDetails>\r\n          </Accordion>\r\n          <Accordion>\r\n            <AccordionSummary\r\n              expandIcon={<ExpandMoreIcon />}\r\n              aria-controls=\"panel2bh-content\"\r\n              id=\"panel2bh-header\"\r\n            >\r\n              <Typography sx={{ width: '33%', flexShrink: 0 }}>Users</Typography>\r\n              <Typography sx={{ color: 'text.secondary' }}>\r\n                You are currently not an owner\r\n              </Typography>\r\n            </AccordionSummary>\r\n            <AccordionDetails>\r\n              <Typography>\r\n                Donec placerat, lectus sed mattis semper, neque lectus feugiat lectus,\r\n                varius pulvinar diam eros in elit. Pellentesque convallis laoreet\r\n                laoreet.\r\n              </Typography>\r\n            </AccordionDetails>\r\n          </Accordion>\r\n          <Accordion>\r\n            <AccordionSummary\r\n              expandIcon={<ExpandMoreIcon />}\r\n              aria-controls=\"panel3bh-content\"\r\n              id=\"panel3bh-header\"\r\n            >\r\n              <Typography sx={{ width: '33%', flexShrink: 0 }}>\r\n                Advanced settings\r\n              </Typography>\r\n              <Typography sx={{ color: 'text.secondary' }}>\r\n                Filtering has been entirely disabled for whole web server\r\n              </Typography>\r\n            </AccordionSummary>\r\n            <AccordionDetails>\r\n              <Typography>\r\n                Nunc vitae orci ultricies, auctor nunc in, volutpat nisl. Integer sit\r\n                amet egestas eros, vitae egestas augue. Duis vel est augue.\r\n              </Typography>\r\n            </AccordionDetails>\r\n          </Accordion>\r\n          <Accordion>\r\n            <AccordionSummary\r\n              expandIcon={<ExpandMoreIcon />}\r\n              aria-controls=\"panel4bh-content\"\r\n              id=\"panel4bh-header\"\r\n            >\r\n              <Typography sx={{ width: '33%', flexShrink: 0 }}>Personal data</Typography>\r\n            </AccordionSummary>\r\n            <AccordionDetails>\r\n              <Typography>\r\n                Nunc vitae orci ultricies, auctor nunc in, volutpat nisl. Integer sit\r\n                amet egestas eros, vitae egestas augue. Duis vel est augue.\r\n              </Typography>\r\n            </AccordionDetails>\r\n          </Accordion>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\n\r\n\r\n\r\n// ========================================\r\n\r\nReactDOM.render(\r\n  <Game />,\r\n  document.getElementById('root')\r\n);\r\n"],"sourceRoot":""}