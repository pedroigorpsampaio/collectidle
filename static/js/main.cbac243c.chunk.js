(this["webpackJsonpreact-to-iso-render"]=this["webpackJsonpreact-to-iso-render"]||[]).push([[0],{0:function(t){t.exports=JSON.parse('{"TILESIZE":64,"BOARD_HEIGHT":200,"BOARD_WIDTH":200,"BOARD_LAYERS":1}')},25:function(t,e,a){},40:function(t,e,a){"use strict";a.r(e),a.d(e,"STATE_LOADING",(function(){return D})),a.d(e,"STATE_RUNNING",(function(){return C}));var s=a(4),i=a(5),o=a(7),r=a(6),n=a(1),A=a.n(n),c=a(16),h=a.n(c),l=(a(25),a(0)),u="data:image/png;base64,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",g=a.p+"static/media/2.3b93bd89.png",d=a(3),p=function(t){Object(o.a)(a,t);var e=Object(r.a)(a);function a(){return Object(s.a)(this,a),e.apply(this,arguments)}return Object(i.a)(a,[{key:"render",value:function(){var t=u,e=null===this.props.opacity?1:this.props.opacity,a=null===this.props.saturation?1:this.props.saturation;return 0===this.props.value?null:(this.props.value%2===0?t="data:image/png;base64,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":this.props.value%3===0&&(t=g),Object(d.jsx)("img",{src:t,alt:"iso tile",width:l.TILESIZE*this.props.camera.zoom,height:l.TILESIZE*this.props.camera.zoom,style:{opacity:e,position:"absolute",filter:"saturate("+a+")",zIndex:this.props.zIndex,top:this.props.top,left:this.props.left}}))}}]),a}(A.a.PureComponent),m=function t(){Object(s.a)(this,t),this.x=l.INIT_X,this.y=l.INIT_Y,this.speed=1,this.zoom=1,this.width=4,this.height=4,this.max_zoom=4,this.angle=0},f=a.p+"static/media/bg_world.4fae2a5e.gif",I=a(8),v=a(2),B=a(9),T=function t(){Object(s.a)(this,t),this.offset_x=0,this.offset_y=0,this.width=0,this.height=0,this.rfWidth=0,this.rfHeight=0},w=function(t){Object(o.a)(a,t);var e=Object(r.a)(a);function a(t){var i;Object(s.a)(this,a),(i=e.call(this,t)).handleMouseClick=function(t){"mousedown"===t.type?(i.setState({isMouseDown:!0}),i.setState({lastX:t.pageX,lastY:t.pageY,lastDragX:t.pageX,lastDragY:t.pageY})):i.setState({isMouseDown:!1})},i.resize=function(){var t=Math.abs(i.viewport.rfWidth-.7*window.innerWidth),e=Math.abs(i.viewport.rfHeight-.95*window.innerHeight),a=l.TILESIZE*i.state.camera.zoom;(t>=a/8||e>=a/8)&&(i.forceUpdate(),i.setState({delta:t+e}))},i.placeI=null,i.placeJ=null,i.viewport=new T,i.state={tiles:i.props.tiles,x:0,y:0,camera:new m,isMouseDown:!1,isDragging:!1,isBuilding:!1,selectedTile:1,lastX:0,lastY:0,lastDragX:0,lastDragY:0,lastTick:0};var o=i.getBoardCenter();return i.state.camera.x=o.x,i.state.camera.y=o.y,i}return Object(i.a)(a,[{key:"loadTiles",value:function(){var t=this.state.tiles.slice();t[l.BOARD_HEIGHT/2][l.BOARD_WIDTH/2]=1,this.setState({tiles:t})}},{key:"getBoardCenter",value:function(){var t=l.BOARD_WIDTH,e=l.BOARD_HEIGHT;return new I.Vector(.7*window.innerWidth/2-l.TILESIZE*this.state.camera.zoom/2-(t-e)*(l.TILESIZE*this.state.camera.zoom/2)/2,.95*window.innerHeight/2-(e+t)*(l.TILESIZE*this.state.camera.zoom/4)/2)}},{key:"center",value:function(){var t=this.state.tiles[0].length,e=this.state.tiles.length,a=new I.Vector(.7*window.innerWidth/2-l.TILESIZE*this.state.camera.zoom/2-(t-e)*(l.TILESIZE*this.state.camera.zoom/2)/2,.95*window.innerHeight/2-(e+t)*(l.TILESIZE*this.state.camera.zoom/4)/2),s=Object.assign({},this.state.camera);s.x=a.x,s.y=a.y,this.setState({camera:s})}},{key:"getCenter",value:function(){var t=this.state.tiles[0].length,e=this.state.tiles.length,a=(t-e)*(l.TILESIZE*this.state.camera.zoom/2)/2,s=(e+t)*(l.TILESIZE*this.state.camera.zoom/4)/2;return new I.Vector(this.state.camera.x+a+l.TILESIZE*this.state.camera.zoom/2,this.state.camera.y+s)}},{key:"onMouseMove",value:function(t){if(t.preventDefault(),this.setState({x:t.pageX,y:t.pageY}),this.state.isMouseDown)if(2===t.buttons){this.setState({isDragging:!0,lastDragX:t.pageX,lastDragY:t.pageY});var e=new I.Vector(t.pageX,t.pageY),a=new I.Vector(this.state.lastDragX,this.state.lastDragY),s=e.subtract(a);this.updateCamera(s)}else 1===t.buttons&&this.state.isBuilding&&this.placeBlock();else this.setState({isDragging:!1})}},{key:"updateCamera",value:function(t){var e=Object.assign({},this.state.camera);e.x+=t.x,e.y+=t.y,this.setState({camera:e})}},{key:"rotate",value:function(t){for(var e=this.state.tiles.slice(),a=this.getCenter(e[0]).x,s=e.length,i=e[0].length,o=[],r=0;r<i;r++)o[r]=Array(s);for(var n=0;n<s;n++)for(var A=0;A<i;A++){var c="clockwise"===t?s-n-1:n,h="clockwise"===t?A:i-A-1;o[A][n]=e[c][h]}var l=o.slice(),u=this.getCenter(l).x-a,g=Object.assign({},this.state.camera);g.x-=u,this.setState({tiles:l,camera:g})}},{key:"handleClick",value:function(t,e,a){if(this.state.isDragging||this.state.isBuilding)this.state.isBuilding&&this.placeBlock();else{var s=this.state.tiles.slice();if("undefined"==typeof s)return;var i=this.convertToMap(e,a),o=Math.floor(i[0]),r=Math.floor(i[1]),n=this.getTopFactor(o,r,e,a);0!==s[o][r]&&n>0&&n<=1&&(s[o][r]=0),this.setState({tiles:s})}}},{key:"convertToMap",value:function(t,e){var a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],s=l.TILESIZE*this.state.camera.zoom,i=s/2,o=t-i-this.state.camera.x-this.viewport.offset_x,r=e-this.state.camera.y-this.viewport.offset_y,n=Math.trunc(r/i-o/s),A=Math.trunc(r/i+o/s);return a&&(n<0&&(n=0),n>=this.state.tiles.length&&(n=this.state.tiles.length-1),A<0&&(A=0),A>=this.state.tiles[0].length&&(A=this.state.tiles[0].length-1)),[n,A]}},{key:"getTopFactor",value:function(t,e,a,s){var i=(e-t)*(l.TILESIZE*this.state.camera.zoom/2)+this.state.camera.x,o=(t+e)*(l.TILESIZE*this.state.camera.zoom/4)+this.state.camera.y,r=a-this.viewport.offset_x,n=s-this.viewport.offset_y,A=o+l.TILESIZE*this.state.camera.zoom/4,c=i+l.TILESIZE*this.state.camera.zoom/2,h=2*Math.abs(n-A);return(Math.abs(r-c)+h)/(l.TILESIZE*this.state.camera.zoom/4+l.TILESIZE*this.state.camera.zoom/4)}},{key:"renderTilemap",value:function(){for(var t=[],e=l.TILESIZE*this.state.camera.zoom,a=this.state.camera.x-this.getBoardCenter().x,s=this.state.camera.y-this.getBoardCenter().y,i=Math.round(a/(e/2)),o=Math.round(s/(e/2)),r=Math.ceil(l.BOARD_HEIGHT/2),n=[Math.round(l.BOARD_WIDTH/2),Math.round(l.BOARD_HEIGHT/2)],A=Math.ceil(this.viewport.width/(e/2))+3,c=Math.ceil(this.viewport.height/(e/2))+2,h=n[0]+n[1]-o-r-Math.ceil(c/2),u=n[0]+n[1]-o-r+Math.ceil(c/2),g=n[0]-n[1]-i-Math.ceil(A/2),d=n[0]-n[1]-i+Math.ceil(A/2),p=h;p<u;p++)for(var m=g;m<d;m++){var f=Math.round(p+m/2),I=Math.round(p-m/2);f<0||f>=l.BOARD_WIDTH||I<0||I>=l.BOARD_HEIGHT||0!==this.state.tiles[I][f]&&t.push(this.renderPixiTile(I,f,t.length))}return this.viewport.rfWidth=this.viewport.width,this.viewport.rfHeight=this.viewport.height,t}},{key:"renderPixiTile",value:function(t,e,a){return Object(d.jsx)(B.Sprite,{scale:this.state.camera.zoom,x:(e-t)*(l.TILESIZE*this.state.camera.zoom/2)+this.state.camera.x,y:(t+e)*(l.TILESIZE*this.state.camera.zoom/4)+this.state.camera.y,zIndex:t+e+2,image:u},a)}},{key:"renderTile",value:function(t,e,a){return Object(d.jsx)(p,{value:this.state.tiles[t][e],camera:this.state.camera,zIndex:t+e+2,top:(t+e)*(l.TILESIZE*this.state.camera.zoom/4)+this.state.camera.y,left:(e-t)*(l.TILESIZE*this.state.camera.zoom/2)+this.state.camera.x},a)}},{key:"renderProjection",value:function(){var t=this.state.tiles.slice(),e=this.state.x-this.viewport.offset_x,a=this.state.y-this.viewport.offset_y-this.state.camera.zoom*l.TILESIZE/4,s=e-this.state.camera.zoom*l.TILESIZE/2,i=.5,o=v.c.NORMAL,r=16777215,n=null,A=null,c=2147483646,h=this.convertToMap(this.state.x,this.state.y),g=Math.floor(h[0]),p=Math.floor(h[1]),m=this.getTopFactor(g,p,this.state.x,this.state.y);if(0!==t[g][p]){if(m>=1&&m<=3){h=this.convertToMap(this.state.x,this.state.y,!1);var f=g=Math.floor(h[0]),I=p=Math.floor(h[1]);1/g===-1/0&&g--,1/p===-1/0&&p--,this.isAtCorner(g,p)||(a=(g+p)*(l.TILESIZE*this.state.camera.zoom/4)+this.state.camera.y,s=(p-g)*(l.TILESIZE*this.state.camera.zoom/2)+this.state.camera.x,i=.5,o=v.c.ADD,r=4652800,n=f,A=I,c=g+p+2)}}else{var T=this.hasNeighbour(g,p);m>0&&m<=1&&T&&(a=(g+p)*(l.TILESIZE*this.state.camera.zoom/4)+this.state.camera.y,s=(p-g)*(l.TILESIZE*this.state.camera.zoom/2)+this.state.camera.x,i=.5,o=v.c.ADD,r=4652800,n=g,A=p,c=g+p+2)}return this.placeI=n,this.placeJ=A,Object(d.jsx)(B.Sprite,{scale:this.state.camera.zoom,x:s,y:a,filters:200,zIndex:c,alpha:i,image:u,blendMode:o,tint:r})}},{key:"hasNeighbour",value:function(t,e){var a=this.state.tiles.slice(),s=e-1>=0&&0!==a[t][e-1],i=e+1<a[t].length&&0!==a[t][e+1],o=t-1>=0&&0!==a[t-1][e],r=t+1<a.length&&0!==a[t+1][e];return s||i||o||r}},{key:"isAtCorner",value:function(t,e){var a=this.state.tiles.slice(),s=-1===e&&-1===t,i=e===a[0].length&&-1===t,o=-1===e&&t===a.length,r=e===a[0].length&&t===a.length;return s||i||o||r}},{key:"toggleBuild",value:function(){this.state.isBuilding?this.setState({isBuilding:!1}):this.setState({isBuilding:!0})}},{key:"placeBlock",value:function(){var t=this.placeI,e=this.placeJ;if(null!=t&&(null!=e&&(t>=0&&(e>=0&&(t<l.BOARD_HEIGHT&&e<l.BOARD_WIDTH))))){var a=this.state.tiles.slice();a[t][e]=this.state.selectedTile,this.setState({tiles:a})}}},{key:"onWheel",value:function(t){var e=-t.deltaY/3200;if(this.state.camera.zoom+e>0&&this.state.camera.zoom+e<=this.state.camera.max_zoom){var a=Object.assign({},this.state.camera),s=a.zoom;a.zoom+=e;var i=a.zoom,o=l.TILESIZE*l.BOARD_HEIGHT*s,r=l.TILESIZE*l.BOARD_HEIGHT*i-o;a.y=a.y-r/4,this.setState({camera:a})}}},{key:"render",value:function(){var t=this;return Object(d.jsx)("div",{className:"game-board",style:{backgroundImage:"url(".concat(f,")"),backgroundSize:"cover",backgroundRepeat:"no-repeat"},onMouseDown:this.handleMouseClick,onMouseUp:this.handleMouseClick,onMouseMove:this.onMouseMove.bind(this),onWheel:this.onWheel.bind(this),ref:function(e){e&&(t.viewport.offset_x=e.getBoundingClientRect().left,t.viewport.offset_y=e.getBoundingClientRect().top,t.viewport.width=e.getBoundingClientRect().right-e.getBoundingClientRect().left,t.viewport.height=e.getBoundingClientRect().bottom-e.getBoundingClientRect().top)},children:Object(d.jsxs)("div",{children:[Object(d.jsxs)(B.Stage,{width:this.viewport.width,height:this.viewport.height,options:{backgroundAlpha:0,resizeTo:window},children:[Object(d.jsxs)(B.Container,{sortableChildren:!0,interactive:!0,pointerup:function(e){return t.handleClick(e,t.state.x,t.state.y)},children:[this.renderTilemap(),this.state.isBuilding?this.renderProjection():null]}),Object(d.jsx)(B.Sprite,{scale:this.state.camera.zoom,x:50,y:50,width:50,height:50,zIndex:2147483647,image:"https://s3-us-west-2.amazonaws.com/s.cdpn.io/693612/coin.png",interactive:!0,buttonMode:!0,pointerup:function(){return t.toggleBuild()}})]}),Object(d.jsx)("button",{className:"rotate-button",onClick:function(){return t.rotate("anticlockwise")},children:"Anti-clockwise"}),Object(d.jsx)("button",{className:"rotate-button",onClick:function(){return t.rotate("clockwise")},children:"Clockwise"}),Object(d.jsx)("button",{className:"center-button",onClick:function(){return t.center()},children:"Center"}),Object(d.jsx)("button",{className:"building-button",onClick:function(){return t.toggleBuild()},children:this.state.isBuilding?"Cancel":"Add Block"})]})})}},{key:"componentDidMount",value:function(){window.addEventListener("resize",this.resize),this.forceUpdate()}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.resize)}}]),a}(A.a.Component),E=w,b=function(){onmessage=function(t){if("loadMap"===t.data.cmd){for(var e=0,a=t.data.rows,s=t.data.columns,i=t.data.defaultValue,o=new Uint8Array(a*s),r=0,n=0;n<a;n++)for(var A=0;A<s;A++){o[r]=i,r++;var c=Math.round(r/(a*s)*100);c!==e&&self.postMessage({cmd:"updateProgress",progress:c}),e=c}self.postMessage({cmd:"receiveBoard",tiles:o.buffer},[o.buffer])}}}.toString();b=b.substring(b.indexOf("{")+1,b.lastIndexOf("}"));var x=new Blob([b],{type:"application/javascript"}),y=URL.createObjectURL(x);var O=a(20),D=1,C=2,L=function(t){Object(o.a)(a,t);var e=Object(r.a)(a);function a(t){var i;return Object(s.a)(this,a),i=e.call(this,t),document.body.style.overflow="hidden",window.addEventListener("contextmenu",(function(t){return t.preventDefault()})),i.state={loadProgress:0,loadText:"Loading map...",current:D,tiles:null},i}return Object(i.a)(a,[{key:"componentDidMount",value:function(){this.loadBoard()}},{key:"matrixify",value:function(t,e,a){var s=[];if(e*a===t.length)for(var i=0;i<t.length;i+=a)s.push(t.slice(i,a+i));return s}},{key:"loadBoard",value:function(){var t=this;window.Worker&&(this.boardWorker=new Worker(y),this.boardWorker.postMessage({cmd:"loadMap",rows:l.BOARD_HEIGHT,columns:l.BOARD_WIDTH,defaultValue:1}),this.boardWorker.onmessage=function(e){if("updateProgress"===e.data.cmd)t.setState({loadProgress:e.data.progress});else if("receiveBoard"===e.data.cmd){var a=new Uint8Array(e.data.tiles);t.setState({tiles:t.matrixify(a,l.BOARD_HEIGHT,l.BOARD_WIDTH),current:C})}})}},{key:"render",value:function(){var t=null;switch(this.state.current){case D:t=this.renderLoadingScreen();break;case C:t=this.renderBoard();break;default:console.log("Unknown game state: Game state must be one of the defined ones")}return t}},{key:"renderBoard",value:function(){return Object(d.jsxs)("div",{className:"game",children:[Object(d.jsx)("div",{children:Object(d.jsx)(E,{tiles:this.state.tiles})}),Object(d.jsxs)("div",{className:"game-info",children:[Object(d.jsx)(O.a,{width:40,height:10,left:0,top:0}),Object(d.jsx)("div",{}),Object(d.jsx)("ol",{})]})]})}},{key:"renderLoadingScreen",value:function(){return Object(d.jsx)("div",{className:"game",children:Object(d.jsxs)("div",{children:[this.state.loadText," (",this.state.loadProgress,")"]})})}}]),a}(A.a.Component);h.a.render(Object(d.jsx)(L,{}),document.getElementById("root"))}},[[40,1,2]]]);
//# sourceMappingURL=main.cbac243c.chunk.js.map