{"version":3,"sources":["assets/0.png","assets/2.png","tile.js","assets/1.png","camera.js","assets/backgrounds/bg_world.gif","board.js","load.js","index.js"],"names":["Tile","tileSprite","tile0","opacity","this","props","saturation","value","tile2","src","alt","width","config","TILESIZE","camera","zoom","height","style","position","filter","zIndex","top","left","React","PureComponent","Camera","x","INIT_X","y","INIT_Y","speed","max_zoom","angle","Viewport","offset_x","offset_y","rfWidth","rfHeight","Board","handleMouseClick","event","type","setState","isMouseDown","lastX","pageX","lastY","pageY","lastDragX","lastDragY","resize","dW","Math","abs","viewport","window","innerWidth","dH","innerHeight","tZ","state","forceUpdate","delta","placeI","placeJ","tiles","isDragging","isBuilding","selectedTile","lastTick","center","getBoardCenter","slice","BOARD_HEIGHT","BOARD_WIDTH","j","i","Vec2D","length","Object","assign","offX","offY","e","preventDefault","buttons","mousePos","lastDrag","offset","subtract","updateCamera","placeBlock","direction","matrix","oldCenterX","getCenter","rows","cols","grid","Array","dirI","dirJ","xOffset","idx","convertToMap","floor","topFactor","getTopFactor","screenX","screenY","limit","TILESIZE_Z","TILE_HALF","trunc","tx","ty","cx","cy","tcy","tcx","offsetY","dX","dY","dTileX","round","dTileY","dInitY","ceil","centerTile","nCols","nRows","minI","maxI","minJ","maxJ","push","renderPixiTile","key","scale","image","mX","blendMode","PIXI","NORMAL","tint","oldI","oldJ","Infinity","isAtCorner","ADD","hasNeighbour","filters","alpha","right","up","down","upLeft","upRight","downLeft","downRight","scroll","deltaY","oldZoom","newZoom","oldHeight","className","backgroundImage","background","backgroundSize","backgroundRepeat","onMouseDown","onMouseUp","onMouseMove","bind","onWheel","ref","el","getBoundingClientRect","bottom","options","backgroundAlpha","resizeTo","sortableChildren","interactive","pointerup","handleClick","renderTilemap","renderProjection","buttonMode","toggleBuild","onClick","rotate","addEventListener","removeEventListener","Component","code","onmessage","data","cmd","PROGRESS_BOARD_LOAD","columns","defaultValue","Uint8Array","count","cProgress","self","postMessage","buffer","toString","substring","indexOf","lastIndexOf","blob","Blob","worker_script","URL","createObjectURL","STATE_LOADING","STATE_RUNNING","Game","document","body","overflow","loadProgress","loadText","current","loadBoard","arr","Worker","boardWorker","Config","progress","matrixify","content","renderLoadingScreen","renderBoard","console","log","ReactDOM","render","getElementById"],"mappings":"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","file":"static/js/main.cbac243c.chunk.js","sourcesContent":["export default \"data:image/png;base64,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\"","export default __webpack_public_path__ + \"static/media/2.3b93bd89.png\";","import React from 'react';\r\nimport config from './config.json';\r\nimport tile0 from './assets/0.png';\r\nimport tile1 from './assets/1.png';\r\nimport tile2 from './assets/2.png';\r\n\r\n/**\r\n * Pure component tile class responsible for\r\n * rendering tiles into the game board\r\n */\r\nexport default class Tile extends React.PureComponent {\r\n\r\n    render() {\r\n        var tileSprite = tile0;\r\n        var opacity = this.props.opacity === null ? 1 : this.props.opacity;\r\n        var saturation = this.props.saturation === null ? 1 : this.props.saturation;\r\n    \r\n        if(this.props.value === 0)\r\n        return (null);\r\n        if (this.props.value % 2 === 0)\r\n            tileSprite = tile1;\r\n        else if (this.props.value % 3 === 0)\r\n            tileSprite = tile2;\r\n    \r\n        return (\r\n            <img src={tileSprite} \r\n            alt=\"iso tile\" \r\n            width={config.TILESIZE*this.props.camera.zoom}\r\n            height={config.TILESIZE*this.props.camera.zoom}\r\n            style={{\r\n            opacity: opacity,\r\n            position: 'absolute', \r\n            filter: 'saturate('+saturation+')',\r\n            zIndex: this.props.zIndex,\r\n            top: this.props.top, \r\n            left: this.props.left}}\r\n            />\r\n        );\r\n    }\r\n}","export default \"data:image/png;base64,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\"","import config from './config.json'\r\n\r\n/**\r\n * Camera class for board camera operations\r\n */\r\n export default class Camera {\r\n    x = config.INIT_X;  // current x position of the camera\r\n    y = config.INIT_Y; // current y position of the camera\r\n    speed = 1; // camera speed\r\n    zoom = 1; // current zoom of the camera to the board\r\n    width = 4; // camera width in tiles\r\n    height = 4; // camera height in tiles\r\n    max_zoom = 4; // camera max zoom\r\n    angle = 0; // current camera angle (from 0 to 3 (0, 90, 180 and 270 degrees))\r\n }\r\n","export default __webpack_public_path__ + \"static/media/bg_world.4fae2a5e.gif\";","import React from 'react';\r\nimport config from './config.json'\r\nimport Tile from './tile.js';\r\nimport Camera from './camera.js';\r\nimport background from './assets/backgrounds/bg_world.gif';\r\nimport * as Vec2D from 'vector2d';\r\nimport * as PIXI from 'pixi.js'\r\nimport { Stage, Sprite, Container } from '@inlet/react-pixi'\r\nimport tile0 from './assets/0.png';\r\n\r\n\r\n/**\r\n * Viewport data of this component (board)\r\n */\r\nclass Viewport {\r\n  offset_x = 0; // the x offset of the board in the page\r\n  offset_y = 0; // the y offset of the board in the page\r\n  width = 0; // the viewport width of the game board\r\n  height = 0; // the viewport height of the game board\r\n  rfWidth = 0; // viewport width of last frame rendered\r\n  rfHeight = 0; // viewport height of last frame rendered\r\n}\r\n\r\n/**\r\n * The component for the game board/map\r\n * responsible for operations related to the tilemap\r\n */\r\nclass Board extends React.Component {\r\n    constructor(props) {\r\n      super(props);   \r\n      // sets game world background\r\n\r\n      this.placeI = null; // placement I index (null if not valid)\r\n      this.placeJ = null; // placement J index (null if not valid)\r\n      this.viewport = new Viewport(); // creates viewport object later to be fulfilled \r\n\r\n      this.state = {\r\n        tiles: this.props.tiles,\r\n        x: 0,\r\n        y: 0,\r\n        camera: new Camera(), // creates board camera\r\n        isMouseDown: false,\r\n        isDragging: false,\r\n        isBuilding: false,\r\n        selectedTile: 1,\r\n        lastX: 0,\r\n        lastY: 0,\r\n        lastDragX: 0,\r\n        lastDragY: 0,\r\n        lastTick: 0,\r\n      };\r\n\r\n      //centers camera\r\n      let center = this.getBoardCenter()\r\n      this.state.camera.x = center.x;\r\n      this.state.camera.y = center.y;\r\n    }\r\n\r\n    loadTiles() {\r\n      const tiles = this.state.tiles.slice();\r\n      tiles[config.BOARD_HEIGHT/2][config.BOARD_WIDTH/2] = 1;\r\n      this.setState({tiles:tiles});\r\n    }\r\n      \r\n    /**\r\n     * Returns a Vec2D with the coordinates to center isometric map with camera at 0\r\n     */\r\n    getBoardCenter() {\r\n      let j = config.BOARD_WIDTH;\r\n      let i = config.BOARD_HEIGHT;\r\n      return new Vec2D.Vector(window.innerWidth*0.70/2 - config.TILESIZE*this.state.camera.zoom/2 \r\n                                                        - (j-i)*(config.TILESIZE*this.state.camera.zoom/2)/2, \r\n                              window.innerHeight*0.95/2 - (i+j)*(config.TILESIZE*this.state.camera.zoom/4)/2);\r\n    }\r\n\r\n    /**\r\n     * Position camera in order to position isometric tilemap \r\n     * in the center of the screen \r\n     */\r\n    center() {\r\n      let j = this.state.tiles[0].length;\r\n      let i = this.state.tiles.length;\r\n      let center = new Vec2D.Vector(window.innerWidth*0.70/2 - config.TILESIZE*this.state.camera.zoom/2 \r\n                                                        - (j-i)*(config.TILESIZE*this.state.camera.zoom/2)/2, \r\n                              window.innerHeight*0.95/2 - (i+j)*(config.TILESIZE*this.state.camera.zoom/4)/2)\r\n      const camera = Object.assign({}, this.state.camera);                        \r\n      camera.x = center.x;\r\n      camera.y = center.y;\r\n      this.setState({camera: camera});\r\n    }\r\n\r\n    /**\r\n     * Get center coordinates of the isometric map current position\r\n     */\r\n    getCenter() {\r\n      let j = this.state.tiles[0].length;\r\n      let i = this.state.tiles.length;\r\n      let offX = (j-i)*(config.TILESIZE*this.state.camera.zoom/2)/2;\r\n      let offY = (i+j)*(config.TILESIZE*this.state.camera.zoom/4)/2;\r\n      return new Vec2D.Vector(this.state.camera.x + offX + config.TILESIZE*this.state.camera.zoom/2, \r\n                                            this.state.camera.y + offY);\r\n    }\r\n    \r\n  \r\n    /**\r\n     * Handles mouse up and down events\r\n     * @param {The event that tirggered this callback} event \r\n     */\r\n    handleMouseClick = (event) => {\r\n      if (event.type === \"mousedown\") {\r\n             this.setState({ isMouseDown: true});\r\n             // saves the position last clicked;\r\n             this.setState({lastX: event.pageX, lastY: event.pageY, lastDragX: event.pageX, lastDragY: event.pageY})         \r\n         } else {\r\n             this.setState({ isMouseDown: false});\r\n         }\r\n     }\r\n  \r\n     /**\r\n      * Handles mouse movements events\r\n      * @param {the event data} e \r\n      */\r\n    onMouseMove(e) {\r\n      e.preventDefault()\r\n      this.setState({x: e.pageX, y: e.pageY });\r\n     \r\n      if(this.state.isMouseDown) {\r\n        // drag event\r\n        if(e.buttons === 2) {\r\n          this.setState({isDragging: true, lastDragX: e.pageX, lastDragY: e.pageY});\r\n          // calculates drag direction \r\n          const mousePos = new Vec2D.Vector(e.pageX, e.pageY);\r\n          const lastDrag = new Vec2D.Vector(this.state.lastDragX, this.state.lastDragY);\r\n          const offset = mousePos.subtract(lastDrag)\r\n          // adjusts camera accordingly\r\n          this.updateCamera(offset)\r\n        } else if(e.buttons === 1) { // if it is left click\r\n            if(this.state.isBuilding) // if it is building\r\n              this.placeBlock(); // delegate block placement to the method responsible for it\r\n        }\r\n      } else {\r\n        this.setState({isDragging: false});\r\n      }\r\n    }\r\n  \r\n    /**\r\n     * Updates camera's current position\r\n     * @param {offset to be added to the camera's current position} offset \r\n     */\r\n    updateCamera(offset) {\r\n      const camera = Object.assign({}, this.state.camera); \r\n      camera.x += offset.x;\r\n      camera.y += offset.y; \r\n      this.setState({camera:camera});   \r\n    }\r\n  \r\n    /**\r\n     * Rotates board in the desired direction orientation\r\n     */\r\n    rotate(direction) {\r\n      const matrix = this.state.tiles.slice();\r\n      const oldCenterX = this.getCenter(matrix[0]).x;\r\n\r\n      const rows = matrix.length, cols = matrix[0].length;\r\n      const grid = [];\r\n      for (let j = 0; j < cols; j++) {\r\n        grid[j] = Array(rows);\r\n      }\r\n      for (let i = 0; i < rows; i++) {\r\n        for (let j = 0; j < cols; j++) {\r\n          let dirI = direction === \"clockwise\" ? rows-i-1 : i; \r\n          let dirJ = direction === \"clockwise\" ? j : cols-j-1;\r\n          grid[j][i] = matrix[dirI][dirJ];\r\n        }\r\n      }\r\n      const tiles = grid.slice();\r\n       \r\n      const xOffset = this.getCenter(tiles).x - oldCenterX;\r\n      const camera = Object.assign({}, this.state.camera); \r\n      camera.x -= xOffset;\r\n      this.setState({tiles: tiles, camera:camera});  \r\n    }\r\n  \r\n    /**\r\n     * Handles click interactions in the board tiles\r\n     * @param {the x coord of the click to be handled} x \r\n     * @param {the y coord of the click to be handled} y \r\n     */\r\n    handleClick(e, x, y) {\r\n      if(!this.state.isDragging && !this.state.isBuilding) {\r\n        const tiles = this.state.tiles.slice();\r\n\r\n        // dont mess with undefined\r\n        if (typeof tiles == \"undefined\")\r\n          return;\r\n\r\n        var idx = this.convertToMap(x, y);\r\n        var i = Math.floor(idx[0]);\r\n        var j = Math.floor(idx[1]);\r\n        \r\n        // precision calculation to consider only the top plane of cube\r\n        let topFactor = this.getTopFactor(i, j, x, y);\r\n        \r\n        // if it hits some existing block\r\n        if(tiles[i][j] !== 0) {     \r\n          \r\n          // Click on a valid cube plane!!! Success!!!!!\r\n          if(topFactor > 0 && topFactor <= 1) {\r\n            tiles[i][j] = 0; // updates it\r\n          } \r\n\r\n        }\r\n\r\n        // updates layers in game state\r\n        this.setState({tiles: tiles});\r\n      } else if(this.state.isBuilding) { // is in building mode (able to place blocks)\r\n        this.placeBlock();\r\n      }\r\n    }\r\n  \r\n    /**\r\n     * Converts coordinates in the screen space (X,Y) of the page\r\n     * to the map coordinates (i,j)\r\n     * @param {The x - the x coordinate to be converted to map index j } screenX \r\n     * @param {The y - the y coordinate to be converted to map index i } screenY \r\n     * @param {*} limit if calculations should be limited by board boundaries (default = true)\r\n     */\r\n    convertToMap(screenX, screenY, limit = true) {\r\n      let TILESIZE_Z = config.TILESIZE * this.state.camera.zoom;\r\n      let TILE_HALF = TILESIZE_Z / 2;\r\n  \r\n      let x = screenX - TILE_HALF - this.state.camera.x - this.viewport.offset_x;\r\n      let y = screenY - this.state.camera.y - this.viewport.offset_y\r\n      let i = Math.trunc((y/TILE_HALF) - (x/TILESIZE_Z));\r\n      let j = Math.trunc((y/TILE_HALF) + (x/TILESIZE_Z));\r\n\r\n      // limits i and j to be inside board boundaries\r\n      if(limit) {\r\n      // makes sure we do not surpass the map 2darray limits\r\n        if (i < 0) i = 0; if(i>=this.state.tiles.length) i = this.state.tiles.length-1;\r\n        if (j < 0) j = 0; if(j>=this.state.tiles[0].length) j = this.state.tiles[0].length-1;\r\n      }\r\n  \r\n      return [i, j];\r\n    }\r\n\r\n    /**\r\n     * Returns a value that indicates if a point is within\r\n     * the top plane of a given tile in the map\r\n     * (the factor indicates it is in top plane when its value is between 0 and 1)\r\n     * @param {*} i the i-index of the tile to be checked\r\n     * @param {*} j the j-index of the tile to be checked\r\n     * @param {*} screenX the x-index of the mouse click in the page\r\n     * @param {*} screenY the y-index of the mouse click in the page\r\n     * @returns factor that indicates if click is in top plane when its value is between 0 and 1 \r\n     *          or out of the top plane when it is not\r\n     */\r\n    getTopFactor(i, j, screenX, screenY) {\r\n     /**\r\n     * tx,ty: coordinates of the tile in page (top-left orientation)\r\n     * tcx,tcy: coordinates of the middle of the tile\r\n     * cx, cy: coordinates of the click in the page\r\n     * offsetX,Y: offset relation between click and middle of the tile\r\n     * topFactor: factor from that indicates when click is on the top plane of cube (from 0 to 1 = click in top plane)\r\n     */\r\n      let tx =(j-i)*(config.TILESIZE*this.state.camera.zoom/2) + this.state.camera.x;\r\n      let ty =(i+j)*(config.TILESIZE*this.state.camera.zoom/4) + this.state.camera.y;\r\n      let cx = screenX - this.viewport.offset_x;\r\n      let cy = screenY - this.viewport.offset_y;\r\n      let tcy = ty + (config.TILESIZE*this.state.camera.zoom/4);\r\n      let tcx = tx + (config.TILESIZE*this.state.camera.zoom/2);\r\n      let offsetY = Math.abs(cy - tcy) * 2;\r\n      let offsetX = Math.abs(cx - tcx);\r\n      return (offsetX+offsetY)/((config.TILESIZE*this.state.camera.zoom/4)+(config.TILESIZE*this.state.camera.zoom/4));\r\n    }\r\n\r\n    /**\r\n     * Renders tile map by rendering its rows and columns.\r\n     * Calculates which tiles are visible in the viewport\r\n     * and then calls the method to render the tile\r\n     */\r\n    renderTilemap() {\r\n      let rows = [];\r\n      let tZ= config.TILESIZE*this.state.camera.zoom;\r\n      let dX = this.state.camera.x - this.getBoardCenter().x;\r\n      let dY = this.state.camera.y - this.getBoardCenter().y;\r\n      let dTileX = Math.round(dX / (tZ/2));\r\n      let dTileY = Math.round(dY / (tZ/2));\r\n      let dInitY = Math.ceil(config.BOARD_HEIGHT / (2));\r\n      let centerTile = [Math.round(config.BOARD_WIDTH/2), Math.round(config.BOARD_HEIGHT/2)];\r\n      let nCols = Math.ceil(this.viewport.width / (tZ/2))+3;\r\n      let nRows = Math.ceil(this.viewport.height / (tZ/2))+2;\r\n      let minI = (centerTile[0]+centerTile[1]-dTileY-dInitY) - (Math.ceil(nRows/2)); let maxI = (centerTile[0]+centerTile[1]-dTileY-dInitY) + (Math.ceil(nRows/2));\r\n      let minJ = (centerTile[0]-centerTile[1]-dTileX) - (Math.ceil(nCols/2)); let maxJ = (centerTile[0]-centerTile[1]-dTileX) + (Math.ceil(nCols/2));\r\n\r\n      for(let i = minI; i < maxI; i++) {\r\n        for(let j = minJ; j < maxJ; j++) {\r\n          let x = Math.round(i+j/2);\r\n          let y = Math.round(i-j/2);\r\n \r\n          if(x<0 || x>=config.BOARD_WIDTH || y<0 || y>= config.BOARD_HEIGHT) continue;\r\n\r\n          // only push to be rendered if its not an empty tile slot\r\n          if(this.state.tiles[y][x] !== 0)\r\n            rows.push(this.renderPixiTile(y,x, rows.length));\r\n        }\r\n      }\r\n      // updates viewport dimensions of this rendered frame\r\n      this.viewport.rfWidth = this.viewport.width; this.viewport.rfHeight = this.viewport.height;\r\n\r\n      return rows;\r\n    }\r\n\r\n    renderPixiTile(i, j, key) {\r\n      return(\r\n        <Sprite\r\n          key={key}\r\n          scale={this.state.camera.zoom}\r\n          x={(j-i)*(config.TILESIZE*this.state.camera.zoom/2) + this.state.camera.x}\r\n          y={(i+j)*(config.TILESIZE*this.state.camera.zoom/4) + this.state.camera.y}\r\n          zIndex = {i+j+2}\r\n          image={tile0}\r\n        />\r\n      )\r\n\r\n    }\r\n   \r\n    /**\r\n     * Renders the tile\r\n     * @param {The i-index of the tile} i \r\n     * @param {The j-index of the tile} j \r\n     */\r\n    renderTile(i, j, key) {\r\n      return (\r\n        <Tile \r\n          value={this.state.tiles[i][j]} \r\n          key={key}\r\n          //onClick={() => this.handleClick(i, j)}\r\n          camera = {this.state.camera}\r\n          zIndex = {i+j+2}\r\n          top={(i+j)*(config.TILESIZE*this.state.camera.zoom/4) + this.state.camera.y}\r\n          left={(j-i)*(config.TILESIZE*this.state.camera.zoom/2) + this.state.camera.x}\r\n        />\r\n      )\r\n      \r\n    }\r\n\r\n    // renders projection ofselected tile on tilemap on mouse move position\r\n    // and updates placement position valid candidates in case of user click\r\n    renderProjection () {\r\n      const tiles = this.state.tiles.slice();\r\n      const mX = this.state.x - this.viewport.offset_x;\r\n      const mY = this.state.y - this.viewport.offset_y\r\n      var top = mY - this.state.camera.zoom*config.TILESIZE/4;\r\n      var left = mX - this.state.camera.zoom*config.TILESIZE/2;\r\n      var opacity = 0.5;\r\n      var blendMode = PIXI.BLEND_MODES.NORMAL;\r\n      var tint = 0xFFFFFF;\r\n      // placement position (null if not valid)\r\n      var placeI = null ; var placeJ = null; var zIndex = 2147483646;\r\n\r\n      var idx = this.convertToMap(this.state.x, this.state.y);\r\n      var i = Math.floor(idx[0]);\r\n      var j = Math.floor(idx[1]);\r\n\r\n      // precision calculation\r\n      let topFactor = this.getTopFactor(i, j, this.state.x, this.state.y);\r\n\r\n      if(tiles[i][j] !== 0) {  // borders of board\r\n        if(topFactor >= 1 && topFactor <= 3) { // is within acceptable distance of border and has neighbour\r\n          idx = this.convertToMap(this.state.x, this.state.y, false); // gets position \r\n          i = Math.floor(idx[0]);\r\n          j = Math.floor(idx[1]);\r\n          const oldI = i; const oldJ = j; // stores preprojection pos with limit at 0\r\n\r\n          if(1/i === -Infinity) i--; // correction to project with i < 0\r\n          if(1/j === -Infinity) j--; // correction to project with j < 0\r\n\r\n          if(!this.isAtCorner(i, j)) {\r\n            top=(i+j)*(config.TILESIZE*this.state.camera.zoom/4) + this.state.camera.y\r\n            left=(j-i)*(config.TILESIZE*this.state.camera.zoom/2) + this.state.camera.x\r\n            opacity = 0.5; blendMode = PIXI.BLEND_MODES.ADD; tint = 0x46ff00;\r\n            placeI = oldI; placeJ = oldJ; // updates placement indexes with a valid placement position\r\n            zIndex = i+j+2;\r\n          }\r\n        }\r\n      } else { // empty slot is a valid position if there is a neighbour tile\r\n        const hasNeighbour = this.hasNeighbour(i, j);\r\n\r\n        // if is within the projected top plane of cube to be placed and has a neighbour\r\n        if(topFactor > 0 && topFactor <= 1 && hasNeighbour) {\r\n          //console.log(\"Im a valid poisition to place block\");\r\n          top=(i+j)*(config.TILESIZE*this.state.camera.zoom/4) + this.state.camera.y\r\n          left=(j-i)*(config.TILESIZE*this.state.camera.zoom/2) + this.state.camera.x\r\n          opacity = 0.5; blendMode = PIXI.BLEND_MODES.ADD; tint = 0x46ff00;\r\n          placeI = i; placeJ = j; // updates placement indexes with a valid placement position\r\n          zIndex = i+j+2;\r\n        }\r\n      }\r\n\r\n      // updates placement position with null in case of invalid position\r\n      // or with the indexes of a valid position\r\n      this.placeI = placeI; this.placeJ = placeJ;\r\n\r\n      // return ( \r\n      //   <Tile \r\n      //     value={this.state.selectedTile} \r\n      //     camera = {this.state.camera}\r\n      //     opacity = {opacity}\r\n      //     zIndex = {zIndex}\r\n      //     saturation = {saturation}\r\n      //     top={top}\r\n      //     left={left}\r\n      //   />\r\n      // );\r\n\r\n      return(\r\n        <Sprite\r\n          scale={this.state.camera.zoom}\r\n          x={left}\r\n          y={top}\r\n          filters={200}\r\n          zIndex = {zIndex}\r\n          alpha = {opacity}\r\n          image={tile0}\r\n          blendMode={blendMode}\r\n          tint={tint}\r\n        />\r\n      )\r\n    }\r\n\r\n    /**\r\n     * Return if a tile in a given position (i,j) has a valid neighbour (value != 0)\r\n     * @param {*} i the i-index of the tile to check neighbours\r\n     * @param {*} j the j-index of the tile to check neighbours\r\n     */\r\n    hasNeighbour(i, j) {\r\n      const tiles = this.state.tiles.slice();\r\n      const left = j-1 >= 0 ? (tiles[i][j-1] !== 0 ? true : false) : false;\r\n      const right = j+1 < tiles[i].length ? (tiles[i][j+1] !== 0 ? true : false) : false;\r\n      const up = i-1 >= 0 ? (tiles[i-1][j] !== 0 ? true : false) : false;\r\n      const down = i+1 < tiles.length ? (tiles[i+1][j] !== 0 ? true : false) : false;\r\n      return left || right || up || down;\r\n    }\r\n\r\n    /**\r\n     * Check if it is at the corner of board (outside tiles that are attached to one of the four board corners)\r\n     * @param {*} i the i-index of the tile to check if it is at board boundaries corner\r\n     * @param {*} j the j-index of the tile to check if it is at board boundaries corner\r\n     */\r\n    isAtCorner(i, j) {\r\n      const tiles = this.state.tiles.slice();\r\n      const upLeft = j === -1 ? (i === -1 ? true : false) : false;\r\n      const upRight = j === tiles[0].length ? (i === -1 ? true : false) : false;\r\n      const downLeft = j === -1 ? (i === tiles.length ? true : false) : false;\r\n      const downRight = j === tiles[0].length ? (i === tiles.length ? true : false) : false;\r\n      return upLeft || upRight || downLeft || downRight;\r\n    }\r\n\r\n    /**\r\n     * changes related to the building mode\r\n     */\r\n    toggleBuild() {\r\n      this.state.isBuilding ? this.setState({isBuilding:false}) : this.setState({isBuilding:true});\r\n    }\r\n\r\n    /**\r\n     * Place block in the stored placement position\r\n     */\r\n    placeBlock() {\r\n      let i = this.placeI; let j = this.placeJ;\r\n      let valid = i != null ? (j != null ? (i >= 0 ? (j>=0? (i < config.BOARD_HEIGHT ? \r\n                                (j < config.BOARD_WIDTH ? true : false) : false) \r\n                                  : false): false) : false) : false;\r\n      if(valid) { // has a valid place to place block\r\n        const tiles = this.state.tiles.slice();\r\n        tiles[i][j] = this.state.selectedTile;\r\n        this.setState({tiles:tiles});\r\n      }\r\n    }\r\n  \r\n    // change zoom based on mwheel\r\n    onWheel (e) {\r\n      let scroll = -e.deltaY/3200;\r\n  \r\n      if((this.state.camera.zoom + scroll) > 0 && (this.state.camera.zoom + scroll) <= this.state.camera.max_zoom) {\r\n        const camera = Object.assign({}, this.state.camera); \r\n        const oldZoom = camera.zoom;\r\n        camera.zoom += scroll;       \r\n        const newZoom = camera.zoom;\r\n        const oldHeight = config.TILESIZE*config.BOARD_HEIGHT*oldZoom;\r\n        const newHeight = config.TILESIZE*config.BOARD_HEIGHT*newZoom;\r\n        const dH = newHeight - oldHeight;\r\n        camera.y = camera.y - dH/4;\r\n        this.setState({camera:camera});\r\n      }\r\n    }\r\n\r\n    render() {\r\n      // let ty =(0+0)*(config.TILESIZE*this.state.camera.zoom/4) + this.state.camera.y - (1*config.TILESIZE*this.state.camera.zoom/2);\r\n      // let cy = this.state.y - this.state.camera.y - this.viewport.offset_y + (1*config.TILESIZE*this.state.camera.zoom/2);\r\n\r\n      //  var test_top = this.state.y - this.viewport.offset_y;\r\n      //  var test_left = this.state.camera.x;\r\n      \r\n      return (\r\n        <div className=\"game-board\" \r\n            style={{ backgroundImage: `url(${background})`,   \r\n                    backgroundSize: 'cover',\r\n                    backgroundRepeat: 'no-repeat',\r\n                  }}\r\n            onMouseDown={ this.handleMouseClick } \r\n            onMouseUp={ this.handleMouseClick } \r\n            onMouseMove={this.onMouseMove.bind(this)}\r\n            onWheel = {this.onWheel.bind(this)}\r\n            ref={el => {\r\n                if (!el) return;\r\n                //const camera = Object.assign({}, this.state.camera); \r\n                this.viewport.offset_x = el.getBoundingClientRect().left;\r\n                this.viewport.offset_y = el.getBoundingClientRect().top;\r\n                this.viewport.width = el.getBoundingClientRect().right - el.getBoundingClientRect().left;\r\n                this.viewport.height = el.getBoundingClientRect().bottom - el.getBoundingClientRect().top;\r\n              }}\r\n        > \r\n          <div\r\n            //onClick={() => this.handleClick(this.state.x, this.state.y)}\r\n            >\r\n              <Stage width = {this.viewport.width} height={this.viewport.height} options={{ backgroundAlpha: 0 , resizeTo: window}}>\r\n                <Container sortableChildren = {true} interactive = {true} pointerup={(e) => this.handleClick(e, this.state.x, this.state.y)}>\r\n                  {this.renderTilemap()}\r\n                  {this.state.isBuilding ? this.renderProjection() : null}\r\n                </Container>\r\n                <Sprite\r\n                    scale={this.state.camera.zoom}\r\n                    x={50}\r\n                    y={50}\r\n                    width={50}\r\n                    height={50}\r\n                    zIndex = {2147483647}\r\n                    image={\"https://s3-us-west-2.amazonaws.com/s.cdpn.io/693612/coin.png\"}\r\n                    interactive={true}\r\n                    buttonMode={true}\r\n                    pointerup={()=>this.toggleBuild()}\r\n                  />\r\n              </Stage>\r\n              \r\n              <button className = \"rotate-button\" onClick={()=>this.rotate(\"anticlockwise\")}>Anti-clockwise</button>\r\n              <button className = \"rotate-button\" onClick={()=>this.rotate(\"clockwise\")}>Clockwise</button>\r\n              <button className = \"center-button\" onClick={()=>this.center()}>Center</button>\r\n              <button className = \"building-button\" onClick={()=>this.toggleBuild()}>{this.state.isBuilding ? \"Cancel\" : \"Add Block\"}</button>\r\n              {/* { <Tile \r\n                value={1} \r\n                //onClick={() => this.handleClick(i, j)}\r\n                camera = {this.state.camera}\r\n                zIndex = {i+j+2}\r\n                top={test_top}\r\n                left={test_left}\r\n              /> } */}\r\n          </div>\r\n        </div>\r\n      );\r\n    }\r\n\r\n    /**\r\n     * Force update on window resize\r\n     */\r\n    resize = () => {\r\n      let dW = Math.abs(this.viewport.rfWidth -  (window.innerWidth*0.70)); \r\n      let dH = Math.abs(this.viewport.rfHeight -  (window.innerHeight*0.95)); \r\n      let tZ = config.TILESIZE * this.state.camera.zoom;\r\n      if(dW >= tZ/8 || dH >= tZ/8) {\r\n        this.forceUpdate();\r\n        this.setState({delta: dW+dH});\r\n      }\r\n    }\r\n\r\n    /**\r\n     * Called when component is mounted\r\n     */\r\n    componentDidMount() {\r\n      window.addEventListener('resize', this.resize);\r\n      this.forceUpdate();\r\n      //this.loadTiles(); // load initial tiles\r\n    }\r\n    \r\n    /**\r\n     * Called when component is unmounted\r\n     */\r\n    componentWillUnmount() {\r\n      window.removeEventListener('resize', this.resize);\r\n    }\r\n  }\r\n\r\n  export default Board;\r\n\r\n\r\n/**\r\n * Creates and fills multidimensional arrays with \r\n * a default value\r\n * Mohammed Ashfaq @ StackOverflow\r\n * @param rows The number of rows for the array\r\n * @param columns The number of columns for the array\r\n * @param defaultValue The default value for each field of the array\r\n * @returns The newly created multidimensional array populated with the default value\r\n */\r\n// function createAndFill2DArray({rows, columns, defaultValue}){\r\n//     return Array.from({ length:rows }, (e, i) => (\r\n//     Array.from({ length:columns }, (e, j)=> defaultValue)));\r\n// }","/**\r\n * Worker listener for loading tasks\r\n */\r\nconst workercode = () => {\r\n    onmessage = function (e) {\r\n        /**\r\n         * Creates a new game board represented by a 2d array\r\n         * @param rows The number of rows for the array\r\n         * @param columns The number of columns for the array\r\n         * @param defaultValue The default value for each field (0 for empty)\r\n         * @returns The newly created multidimensional array populated with the initial disposition of the board\r\n         */\r\n        if (e.data.cmd === \"loadMap\") {\r\n            // progress\r\n            var PROGRESS_BOARD_LOAD = 0;\r\n            // get params\r\n            const rows = e.data.rows; const columns = e.data.columns; const defaultValue = e.data.defaultValue;\r\n            // creates game array as one dimension for faster message transfer\r\n            const tiles = new Uint8Array(rows*columns);\r\n            // count for the progress calculation\r\n            var count = 0;\r\n\r\n            // fills array with default value\r\n            for (let i = 0; i < rows; i++) {\r\n                for (let j = 0; j < columns; j++) {\r\n                    tiles[count] = defaultValue;\r\n                    // updates count\r\n                    count++;\r\n                    // send message to main UI thread in case progress changes\r\n                    let cProgress =  Math.round(100 * (count / (rows * columns)));\r\n                    if(cProgress !== PROGRESS_BOARD_LOAD)\r\n                        self.postMessage({'cmd': 'updateProgress', 'progress' : cProgress}); // eslint-disable-line no-restricted-globals\r\n                    // updates loading progress\r\n                    PROGRESS_BOARD_LOAD = cProgress;\r\n                }\r\n            }\r\n            // send the newly created board\r\n            self.postMessage({cmd:'receiveBoard', tiles: tiles.buffer}, [tiles.buffer]); // eslint-disable-line no-restricted-globals\r\n            //self.postMessage(tiles.buffer, [tiles.buffer]); // eslint-disable-line no-restricted-globals\r\n        }\r\n    };\r\n};\r\n\r\nlet code = workercode.toString();\r\ncode = code.substring(code.indexOf(\"{\") + 1, code.lastIndexOf(\"}\"));\r\n\r\nconst blob = new Blob([code], { type: \"application/javascript\" });\r\nconst worker_script = URL.createObjectURL(blob);\r\n\r\nexport function getWorkerScript() { return worker_script }\r\n\r\n\r\n// returns board creation progress\r\n//export function getProgressBoardLoad() { return PROGRESS_BOARD_LOAD; }","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport './index.css';\r\nimport Board from './board.js';\r\nimport Config from './config.json';\r\nimport * as Load from './load.js';\r\nimport {FpsView} from \"react-fps\";\r\n\r\nexport const STATE_LOADING = 1;\r\nexport const STATE_RUNNING = 2;\r\n\r\nclass Game extends React.Component {\r\n  \r\n  constructor(props) {\r\n    super(props);\r\n    document.body.style.overflow = 'hidden';\r\n    window.addEventListener(\"contextmenu\", e => e.preventDefault());\r\n    this.state = {\r\n      loadProgress: 0,\r\n      loadText: \"Loading map...\",\r\n      current: STATE_LOADING,\r\n      tiles: null\r\n    }\r\n  }\r\n  \r\n  // load game components on mount\r\n  componentDidMount () {\r\n    this.loadBoard();\r\n  }\r\n\r\n  // transform an array into a 2d array/matrix\r\n  matrixify (arr, rows, cols) {\r\n    var matrix = [];\r\n    if (rows * cols === arr.length) {\r\n        for(var i = 0; i < arr.length; i+= cols) {\r\n            matrix.push(arr.slice(i, cols + i));\r\n        }\r\n    }\r\n\r\n    return matrix;\r\n};\r\n  \r\n  /**\r\n   * Loads game board by creating a worker to do the job\r\n   * while update UI until receiving the finished data\r\n   */\r\n  loadBoard() {\r\n    if (window.Worker) {\r\n      // creates worker\r\n      this.boardWorker = new Worker(Load.getWorkerScript());\r\n      // send load map message\r\n      this.boardWorker.postMessage({'cmd': 'loadMap', 'rows': Config.BOARD_HEIGHT, 'columns': Config.BOARD_WIDTH, 'defaultValue': 1});\r\n      this.boardWorker.onmessage = e => {\r\n        if(e.data.cmd === \"updateProgress\")\r\n          this.setState({loadProgress: e.data.progress});\r\n        else  if(e.data.cmd === \"receiveBoard\"){\r\n          const tiles = new Uint8Array(e.data.tiles); // gets board as an Uint8Array to be converted to a matrix and stored\r\n          this.setState({tiles: this.matrixify(tiles, Config.BOARD_HEIGHT, Config.BOARD_WIDTH), current:STATE_RUNNING});\r\n        }\r\n      };\r\n\r\n    }\r\n\r\n\r\n   // while(true) console.log(Load.getProgressBoardLoad());\r\n    //this.setState({current:STATE_RUNNING, tiles:tiles});\r\n  }\r\n\r\n  /**\r\n   * Renders the game based on current state\r\n   */\r\n  render() {\r\n    // switch states to get content\r\n    var content = null;\r\n\r\n    switch(this.state.current) {\r\n      case STATE_LOADING:\r\n        content = this.renderLoadingScreen();\r\n        break;\r\n      case STATE_RUNNING:\r\n        content = this.renderBoard();  \r\n        break;\r\n      default:\r\n        console.log(\"Unknown game state: Game state must be one of the defined ones\");\r\n        break;\r\n    }\r\n\r\n    return content;\r\n  }\r\n\r\n  // Renders Board\r\n  renderBoard() {\r\n    return (\r\n      <div className=\"game\" >\r\n        <div>\r\n          <Board tiles={this.state.tiles}/>\r\n        </div>\r\n        <div className=\"game-info\">\r\n          <FpsView width={40} height={10} left={0} top={0}/>\r\n          <div>{/* status */}</div>\r\n          <ol>{/* TODO */}</ol>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  // Loads game and render loading screen\r\n  renderLoadingScreen() {\r\n    return (\r\n      <div className=\"game\" >\r\n        <div>\r\n          {this.state.loadText} ({this.state.loadProgress})\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n}\r\n\r\n// ========================================\r\n\r\nReactDOM.render(\r\n  <Game />,\r\n  document.getElementById('root')\r\n);\r\n"],"sourceRoot":""}